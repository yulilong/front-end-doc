<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>react使用手册 | 前端知识</title>
    <meta name="description" content="一个总结前端知识的文档网站">
    <link rel="icon" href="/logo.png">
  <script defer="defer" src="/static/jquery.slim.min.js"></script>
  <script defer="defer" src="/static/jquery.fancybox.min.js"></script>
  <link defer="defer" rel="stylesheet" type="text/css" href="/static/jquery.fancybox.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.76f153c4.css" as="style"><link rel="preload" href="/assets/js/app.2afb8482.js" as="script"><link rel="preload" href="/assets/js/201.60704fe0.js" as="script"><link rel="prefetch" href="/assets/js/10.0ef1013d.js"><link rel="prefetch" href="/assets/js/100.59669d01.js"><link rel="prefetch" href="/assets/js/101.741c2686.js"><link rel="prefetch" href="/assets/js/102.47149e7d.js"><link rel="prefetch" href="/assets/js/103.f1eaf177.js"><link rel="prefetch" href="/assets/js/104.f23808ff.js"><link rel="prefetch" href="/assets/js/105.f5bdad72.js"><link rel="prefetch" href="/assets/js/106.b8157b10.js"><link rel="prefetch" href="/assets/js/107.a275a057.js"><link rel="prefetch" href="/assets/js/108.4906ec1c.js"><link rel="prefetch" href="/assets/js/109.b21c5677.js"><link rel="prefetch" href="/assets/js/11.3ee5972a.js"><link rel="prefetch" href="/assets/js/110.11790a6f.js"><link rel="prefetch" href="/assets/js/111.519e46a2.js"><link rel="prefetch" href="/assets/js/112.856c72b2.js"><link rel="prefetch" href="/assets/js/113.1a9718fd.js"><link rel="prefetch" href="/assets/js/114.98562c57.js"><link rel="prefetch" href="/assets/js/115.dd09f294.js"><link rel="prefetch" href="/assets/js/116.3e697856.js"><link rel="prefetch" href="/assets/js/117.9ed54de6.js"><link rel="prefetch" href="/assets/js/118.837075a7.js"><link rel="prefetch" href="/assets/js/119.eeb7356e.js"><link rel="prefetch" href="/assets/js/12.ef92ad8b.js"><link rel="prefetch" href="/assets/js/120.d76e8c70.js"><link rel="prefetch" href="/assets/js/121.5490f8be.js"><link rel="prefetch" href="/assets/js/122.bf95df47.js"><link rel="prefetch" href="/assets/js/123.1246f4df.js"><link rel="prefetch" href="/assets/js/124.1b332371.js"><link rel="prefetch" href="/assets/js/125.e968eefc.js"><link rel="prefetch" href="/assets/js/126.41b0b42d.js"><link rel="prefetch" href="/assets/js/127.8d532027.js"><link rel="prefetch" href="/assets/js/128.e3d0dd45.js"><link rel="prefetch" href="/assets/js/129.2eec7742.js"><link rel="prefetch" href="/assets/js/13.5d83ca59.js"><link rel="prefetch" href="/assets/js/130.184a5326.js"><link rel="prefetch" href="/assets/js/131.55d5602a.js"><link rel="prefetch" href="/assets/js/132.0739ad32.js"><link rel="prefetch" href="/assets/js/133.eb282834.js"><link rel="prefetch" href="/assets/js/134.9df36c58.js"><link rel="prefetch" href="/assets/js/135.6d3b3c22.js"><link rel="prefetch" href="/assets/js/136.f6fc5239.js"><link rel="prefetch" href="/assets/js/137.13c0c004.js"><link rel="prefetch" href="/assets/js/138.d9558cc8.js"><link rel="prefetch" href="/assets/js/139.450241fe.js"><link rel="prefetch" href="/assets/js/14.bb2ca207.js"><link rel="prefetch" href="/assets/js/140.e1bf74b6.js"><link rel="prefetch" href="/assets/js/141.b02477b9.js"><link rel="prefetch" href="/assets/js/142.2d68a06d.js"><link rel="prefetch" href="/assets/js/143.c47820a5.js"><link rel="prefetch" href="/assets/js/144.17e6f31d.js"><link rel="prefetch" href="/assets/js/145.2e8592c6.js"><link rel="prefetch" href="/assets/js/146.720781fb.js"><link rel="prefetch" href="/assets/js/147.bf3ed75b.js"><link rel="prefetch" href="/assets/js/148.9505073e.js"><link rel="prefetch" href="/assets/js/149.f9dd6c7c.js"><link rel="prefetch" href="/assets/js/15.16c14ea6.js"><link rel="prefetch" href="/assets/js/150.90a127d0.js"><link rel="prefetch" href="/assets/js/151.9d50afd2.js"><link rel="prefetch" href="/assets/js/152.fbecf0f6.js"><link rel="prefetch" href="/assets/js/153.32c2bb94.js"><link rel="prefetch" href="/assets/js/154.3c5424d9.js"><link rel="prefetch" href="/assets/js/155.4587c969.js"><link rel="prefetch" href="/assets/js/156.b40288c2.js"><link rel="prefetch" href="/assets/js/157.edd410f1.js"><link rel="prefetch" href="/assets/js/158.ada22e21.js"><link rel="prefetch" href="/assets/js/159.ae4e1769.js"><link rel="prefetch" href="/assets/js/16.70266c95.js"><link rel="prefetch" href="/assets/js/160.1c2e95e3.js"><link rel="prefetch" href="/assets/js/161.764559ae.js"><link rel="prefetch" href="/assets/js/162.f3834de5.js"><link rel="prefetch" href="/assets/js/163.17919df8.js"><link rel="prefetch" href="/assets/js/164.a9b1a7d4.js"><link rel="prefetch" href="/assets/js/165.e649e97a.js"><link rel="prefetch" href="/assets/js/166.02532372.js"><link rel="prefetch" href="/assets/js/167.7d112130.js"><link rel="prefetch" href="/assets/js/168.90c0dfba.js"><link rel="prefetch" href="/assets/js/169.d313ed3c.js"><link rel="prefetch" href="/assets/js/17.1f842ac0.js"><link rel="prefetch" href="/assets/js/170.4d971d67.js"><link rel="prefetch" href="/assets/js/171.6a5296d2.js"><link rel="prefetch" href="/assets/js/172.388c5f2d.js"><link rel="prefetch" href="/assets/js/173.8724128a.js"><link rel="prefetch" href="/assets/js/174.0bee9e04.js"><link rel="prefetch" href="/assets/js/175.0e539288.js"><link rel="prefetch" href="/assets/js/176.69aebc77.js"><link rel="prefetch" href="/assets/js/177.e321e16b.js"><link rel="prefetch" href="/assets/js/178.7a6767c2.js"><link rel="prefetch" href="/assets/js/179.b1cd3d26.js"><link rel="prefetch" href="/assets/js/18.958e91d3.js"><link rel="prefetch" href="/assets/js/180.aa4e26e5.js"><link rel="prefetch" href="/assets/js/181.373fea9f.js"><link rel="prefetch" href="/assets/js/182.00faf1e3.js"><link rel="prefetch" href="/assets/js/183.f5084718.js"><link rel="prefetch" href="/assets/js/184.d853e461.js"><link rel="prefetch" href="/assets/js/185.b0233d58.js"><link rel="prefetch" href="/assets/js/186.46563f8c.js"><link rel="prefetch" href="/assets/js/187.8f099752.js"><link rel="prefetch" href="/assets/js/188.3d2adfff.js"><link rel="prefetch" href="/assets/js/189.56085996.js"><link rel="prefetch" href="/assets/js/19.29243772.js"><link rel="prefetch" href="/assets/js/190.74ee9249.js"><link rel="prefetch" href="/assets/js/191.2912c7b3.js"><link rel="prefetch" href="/assets/js/192.816999ff.js"><link rel="prefetch" href="/assets/js/193.66e79d51.js"><link rel="prefetch" href="/assets/js/194.a0aef591.js"><link rel="prefetch" href="/assets/js/195.ca729864.js"><link rel="prefetch" href="/assets/js/196.5f2550df.js"><link rel="prefetch" href="/assets/js/197.53a5a951.js"><link rel="prefetch" href="/assets/js/198.9b7fd80a.js"><link rel="prefetch" href="/assets/js/199.7d76d45a.js"><link rel="prefetch" href="/assets/js/20.65ee3cb2.js"><link rel="prefetch" href="/assets/js/200.beed8c2d.js"><link rel="prefetch" href="/assets/js/202.0f40a335.js"><link rel="prefetch" href="/assets/js/203.c4a08479.js"><link rel="prefetch" href="/assets/js/204.f281776c.js"><link rel="prefetch" href="/assets/js/205.486b8447.js"><link rel="prefetch" href="/assets/js/206.b9d6473d.js"><link rel="prefetch" href="/assets/js/207.0100e25c.js"><link rel="prefetch" href="/assets/js/208.1f4aeb54.js"><link rel="prefetch" href="/assets/js/209.421e2a33.js"><link rel="prefetch" href="/assets/js/21.f02a2061.js"><link rel="prefetch" href="/assets/js/210.1c1f9f92.js"><link rel="prefetch" href="/assets/js/211.033ec43d.js"><link rel="prefetch" href="/assets/js/212.eaedd29f.js"><link rel="prefetch" href="/assets/js/213.8fa26e5f.js"><link rel="prefetch" href="/assets/js/214.b09ab61f.js"><link rel="prefetch" href="/assets/js/215.ba27a46e.js"><link rel="prefetch" href="/assets/js/216.3d36839f.js"><link rel="prefetch" href="/assets/js/217.c408db8c.js"><link rel="prefetch" href="/assets/js/218.8d420404.js"><link rel="prefetch" href="/assets/js/219.024c3aff.js"><link rel="prefetch" href="/assets/js/22.77807269.js"><link rel="prefetch" href="/assets/js/220.5cd1fed8.js"><link rel="prefetch" href="/assets/js/221.c8398355.js"><link rel="prefetch" href="/assets/js/222.eee93b67.js"><link rel="prefetch" href="/assets/js/223.890a46b1.js"><link rel="prefetch" href="/assets/js/224.af9ae0f2.js"><link rel="prefetch" href="/assets/js/225.64543242.js"><link rel="prefetch" href="/assets/js/226.67eb4e8b.js"><link rel="prefetch" href="/assets/js/227.9dea1e95.js"><link rel="prefetch" href="/assets/js/228.9fd3cd8c.js"><link rel="prefetch" href="/assets/js/229.e3bb4f30.js"><link rel="prefetch" href="/assets/js/23.04033c47.js"><link rel="prefetch" href="/assets/js/230.fd5e90a4.js"><link rel="prefetch" href="/assets/js/231.77d39633.js"><link rel="prefetch" href="/assets/js/232.0fb9b697.js"><link rel="prefetch" href="/assets/js/233.9fd67d1e.js"><link rel="prefetch" href="/assets/js/234.df71f2f9.js"><link rel="prefetch" href="/assets/js/235.72c89c6a.js"><link rel="prefetch" href="/assets/js/236.71d9c1f7.js"><link rel="prefetch" href="/assets/js/237.291e0d2b.js"><link rel="prefetch" href="/assets/js/238.39113381.js"><link rel="prefetch" href="/assets/js/239.468bdffb.js"><link rel="prefetch" href="/assets/js/24.d5ebdf50.js"><link rel="prefetch" href="/assets/js/240.6a6ca3de.js"><link rel="prefetch" href="/assets/js/241.f9a26874.js"><link rel="prefetch" href="/assets/js/242.9d8553eb.js"><link rel="prefetch" href="/assets/js/25.56b8443d.js"><link rel="prefetch" href="/assets/js/26.c90580d1.js"><link rel="prefetch" href="/assets/js/27.ec93c7fa.js"><link rel="prefetch" href="/assets/js/28.38543972.js"><link rel="prefetch" href="/assets/js/29.2d9ac121.js"><link rel="prefetch" href="/assets/js/3.9c9ba874.js"><link rel="prefetch" href="/assets/js/30.566c00ec.js"><link rel="prefetch" href="/assets/js/31.840c7368.js"><link rel="prefetch" href="/assets/js/32.085a9b53.js"><link rel="prefetch" href="/assets/js/33.2568f008.js"><link rel="prefetch" href="/assets/js/34.c693b23c.js"><link rel="prefetch" href="/assets/js/35.0b12ec66.js"><link rel="prefetch" href="/assets/js/36.5de34291.js"><link rel="prefetch" href="/assets/js/37.316e55e2.js"><link rel="prefetch" href="/assets/js/38.fedb1c7b.js"><link rel="prefetch" href="/assets/js/39.3903f3e4.js"><link rel="prefetch" href="/assets/js/4.e2e10cba.js"><link rel="prefetch" href="/assets/js/40.b458a04d.js"><link rel="prefetch" href="/assets/js/41.51efbc84.js"><link rel="prefetch" href="/assets/js/42.5c079c5c.js"><link rel="prefetch" href="/assets/js/43.d67826ec.js"><link rel="prefetch" href="/assets/js/44.e4379bb2.js"><link rel="prefetch" href="/assets/js/45.d1573aa8.js"><link rel="prefetch" href="/assets/js/46.9ed06d3b.js"><link rel="prefetch" href="/assets/js/47.44c98776.js"><link rel="prefetch" href="/assets/js/48.8bcc4819.js"><link rel="prefetch" href="/assets/js/49.ad20e965.js"><link rel="prefetch" href="/assets/js/5.9862dc9a.js"><link rel="prefetch" href="/assets/js/50.e8fde2ac.js"><link rel="prefetch" href="/assets/js/51.73d7229f.js"><link rel="prefetch" href="/assets/js/52.250dc5fe.js"><link rel="prefetch" href="/assets/js/53.f604ad65.js"><link rel="prefetch" href="/assets/js/54.1c7de7b1.js"><link rel="prefetch" href="/assets/js/55.4d268d71.js"><link rel="prefetch" href="/assets/js/56.9da1ef8f.js"><link rel="prefetch" href="/assets/js/57.5a47f404.js"><link rel="prefetch" href="/assets/js/58.f02f1dd9.js"><link rel="prefetch" href="/assets/js/59.866dce11.js"><link rel="prefetch" href="/assets/js/6.ab1c77d5.js"><link rel="prefetch" href="/assets/js/60.b747b975.js"><link rel="prefetch" href="/assets/js/61.dbd99295.js"><link rel="prefetch" href="/assets/js/62.64069c98.js"><link rel="prefetch" href="/assets/js/63.ed8b0dd0.js"><link rel="prefetch" href="/assets/js/64.3acd796b.js"><link rel="prefetch" href="/assets/js/65.b9dbfb42.js"><link rel="prefetch" href="/assets/js/66.61b81117.js"><link rel="prefetch" href="/assets/js/67.8d82f096.js"><link rel="prefetch" href="/assets/js/68.e3a8f010.js"><link rel="prefetch" href="/assets/js/69.4f199ada.js"><link rel="prefetch" href="/assets/js/7.32aa26cb.js"><link rel="prefetch" href="/assets/js/70.5b5eccfe.js"><link rel="prefetch" href="/assets/js/71.a19b24f5.js"><link rel="prefetch" href="/assets/js/72.01636d1f.js"><link rel="prefetch" href="/assets/js/73.4ea8ca9c.js"><link rel="prefetch" href="/assets/js/74.624abc0f.js"><link rel="prefetch" href="/assets/js/75.7e0202b6.js"><link rel="prefetch" href="/assets/js/76.7aaabc49.js"><link rel="prefetch" href="/assets/js/77.90e5533f.js"><link rel="prefetch" href="/assets/js/78.3758ee0d.js"><link rel="prefetch" href="/assets/js/79.15d46be1.js"><link rel="prefetch" href="/assets/js/8.cdadef6d.js"><link rel="prefetch" href="/assets/js/80.952bd008.js"><link rel="prefetch" href="/assets/js/81.3f570b43.js"><link rel="prefetch" href="/assets/js/82.62e50e74.js"><link rel="prefetch" href="/assets/js/83.3bf5ea27.js"><link rel="prefetch" href="/assets/js/84.e89c9df3.js"><link rel="prefetch" href="/assets/js/85.b9ec2ec1.js"><link rel="prefetch" href="/assets/js/86.cf032aea.js"><link rel="prefetch" href="/assets/js/87.5b38d42a.js"><link rel="prefetch" href="/assets/js/88.95904b6f.js"><link rel="prefetch" href="/assets/js/89.700238a1.js"><link rel="prefetch" href="/assets/js/9.b8b9f88e.js"><link rel="prefetch" href="/assets/js/90.3371b61c.js"><link rel="prefetch" href="/assets/js/91.5ac22d50.js"><link rel="prefetch" href="/assets/js/92.5edf548a.js"><link rel="prefetch" href="/assets/js/93.7c2caa65.js"><link rel="prefetch" href="/assets/js/94.af97350f.js"><link rel="prefetch" href="/assets/js/95.977e351c.js"><link rel="prefetch" href="/assets/js/96.783365c1.js"><link rel="prefetch" href="/assets/js/97.1c56ba20.js"><link rel="prefetch" href="/assets/js/98.8bec8d2e.js"><link rel="prefetch" href="/assets/js/99.30c76886.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.102ccaf5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.76f153c4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="前端知识" class="logo"> <span class="site-name can-hide">前端知识</span></a> <div class="links" style="max-width:nullpx;"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/catalog.html" class="nav-link">目录</a></div><div class="nav-item"><a href="/doc/es6/" class="nav-link">ES6</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">javascript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc/js/" class="nav-link">js</a></li><li class="dropdown-item"><!----> <a href="/doc/js/standardLibrary/" class="nav-link">js标准库</a></li><li class="dropdown-item"><!----> <a href="/doc/dom/" class="nav-link">dom操作文档</a></li><li class="dropdown-item"><!----> <a href="/doc/designPattern/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><a href="/doc/browserNetwork/" class="nav-link">浏览器</a></div><div class="nav-item"><a href="/doc/css/" class="nav-link">CSS</a></div><div class="nav-item"><a href="/doc/react/" class="nav-link router-link-active">react</a></div><div class="nav-item"><a href="/doc/vue/" class="nav-link">vue</a></div><div class="nav-item"><a href="/doc/typeScript/" class="nav-link">TypeScript</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc/html/" class="nav-link">html</a></li><li class="dropdown-item"><!----> <a href="/doc/node/" class="nav-link">node</a></li><li class="dropdown-item"><!----> <a href="/doc/tool/" class="nav-link">工具</a></li><li class="dropdown-item"><!----> <a href="/doc/tool/echarts/" class="nav-link">echarts</a></li><li class="dropdown-item"><!----> <a href="/doc/problem/" class="nav-link">常见问题</a></li></ul></div></div> <a href="https://github.com/yulilong/front-end-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/catalog.html" class="nav-link">目录</a></div><div class="nav-item"><a href="/doc/es6/" class="nav-link">ES6</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">javascript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc/js/" class="nav-link">js</a></li><li class="dropdown-item"><!----> <a href="/doc/js/standardLibrary/" class="nav-link">js标准库</a></li><li class="dropdown-item"><!----> <a href="/doc/dom/" class="nav-link">dom操作文档</a></li><li class="dropdown-item"><!----> <a href="/doc/designPattern/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><a href="/doc/browserNetwork/" class="nav-link">浏览器</a></div><div class="nav-item"><a href="/doc/css/" class="nav-link">CSS</a></div><div class="nav-item"><a href="/doc/react/" class="nav-link router-link-active">react</a></div><div class="nav-item"><a href="/doc/vue/" class="nav-link">vue</a></div><div class="nav-item"><a href="/doc/typeScript/" class="nav-link">TypeScript</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc/html/" class="nav-link">html</a></li><li class="dropdown-item"><!----> <a href="/doc/node/" class="nav-link">node</a></li><li class="dropdown-item"><!----> <a href="/doc/tool/" class="nav-link">工具</a></li><li class="dropdown-item"><!----> <a href="/doc/tool/echarts/" class="nav-link">echarts</a></li><li class="dropdown-item"><!----> <a href="/doc/problem/" class="nav-link">常见问题</a></li></ul></div></div> <a href="https://github.com/yulilong/front-end-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/doc/react/" class="sidebar-link">react文档</a></li><li><a href="/doc/react/001-react编程规范.html" class="sidebar-link">react编程规范</a></li><li><a href="/doc/react/002-react使用手册.html" class="one-level one-level-active active sidebar-link">react使用手册</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_1-react样式的写法" class="sidebar-link">1. react样式的写法</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_2-生命周期（lifecycle）" class="sidebar-link">2. 生命周期（Lifecycle）</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_3-ref的使用" class="sidebar-link">3. ref的使用</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_4-context：组件间共享变量" class="sidebar-link">4.Context：组件间共享变量</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_5-setstate-说明" class="sidebar-link">5. setState()说明</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_6-无状态组件sfc" class="sidebar-link">6. 无状态组件SFC</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_7-purecomponent-纯组件" class="sidebar-link">7. PureComponent 纯组件</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_8-fragments-解决必须有一个根节点问题" class="sidebar-link">8. Fragments:解决必须有一个根节点问题</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_9-react中dom元素" class="sidebar-link">9 react中DOM元素</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_10-props-children-容器类组件、插槽" class="sidebar-link">10. props.children(容器类组件、插槽)</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_11-react-children：处理和转化props-children" class="sidebar-link">11. React.Children：处理和转化props.children</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_12-react-children-替代方案" class="sidebar-link">12 React.Children 替代方案</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_13-cloneelement克隆元素" class="sidebar-link">13. cloneElement克隆元素</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_14-函数和函数组件在jsx中区别" class="sidebar-link">14. 函数和函数组件在JSX中区别</a></li><li class="sidebar-sub-header"><a href="/doc/react/002-react使用手册.html#_15-react-memo" class="sidebar-link">15. React.memo</a></li></ul></li><li><a href="/doc/react/003-react代码片段.html" class="sidebar-link">react代码片段</a></li><li><a href="/doc/react/004-react高阶组件.html" class="sidebar-link">高阶组件</a></li><li><a href="/doc/react/005-react开发遇到的问题.html" class="sidebar-link">react开发遇到的问题</a></li><li><a href="/doc/react/005-react中eslint代码检查常见问题解决.html" class="sidebar-link">react中eslint代码检查常见问题解决</a></li><li><a href="/doc/react/006-react平时注意的规范.html" class="sidebar-link">react 平时注意的规范</a></li><li><a href="/doc/react/007-react生命周期.html" class="sidebar-link">react组件生命周期</a></li><li><a href="/doc/react/008-react类型检查PropTypes.html" class="sidebar-link">react类型检查PropTypes</a></li><li><a href="/doc/react/009-react-Hook.html" class="sidebar-link">react Hook</a></li><li><a href="/doc/react/009-hooks.html" class="sidebar-link">React Hooks详解</a></li><li><a href="/doc/react/010-diff算法和性能优化.html" class="sidebar-link">react diff 算法和性能优化</a></li><li><a href="/doc/react/011-react-Virtual-Dom.html" class="sidebar-link">react Virtual DOM</a></li><li><a href="/doc/react/012-react-fiber.html" class="sidebar-link">react Fiber介绍</a></li><li><a href="/doc/react/013-react-dnd拖动组件.html" class="sidebar-link">react-dnd组件使用教程</a></li><li><a href="/doc/react/014-react-refs引用dom.html" class="sidebar-link">refs引用dom</a></li><li><a href="/doc/react/015-react的setState说明.html" class="sidebar-link">react中setState说明</a></li><li><a href="/doc/react/016-react中使用echarts.html" class="sidebar-link">react中使用echarts</a></li><li><a href="/doc/react/017-render-props.html" class="sidebar-link">Render Props</a></li><li><a href="/doc/react/018-react父子组件执行顺序.html" class="sidebar-link">react父子组件交互生命周期执行顺序</a></li><li><a href="/doc/react/019-react类组件和函数组件区别.html" class="sidebar-link">react类组件和函数组件区别</a></li></ul> </div> <div class="page"> <div class="content"><p></p><div class="table-of-contents"><ul><li><a href="#_1-react样式的写法">1. react样式的写法</a><ul><li><a href="#_1-1-jsx中根据条件显示特殊样式">1.1 JSX中根据条件显示特殊样式</a></li><li><a href="#_1-2-多个类样式根据不同条件来显示">1.2 多个类样式根据不同条件来显示</a></li></ul></li><li><a href="#_2-生命周期（lifecycle）">2. 生命周期（Lifecycle）</a><ul><li><a href="#_2-1-mount">2.1 mount</a></li><li><a href="#_2-2-update">2.2 update</a></li><li><a href="#_2-3-unmount">2.3 unmount</a></li></ul></li><li><a href="#_3-ref的使用">3. ref的使用</a></li><li><a href="#_4-context：组件间共享变量">4.Context：组件间共享变量</a><ul><li><a href="#_4-1-api说明">4.1 API说明</a></li><li><a href="#_4-2-使用的例子-发布、使用、修改变量-：">4.2 使用的例子(发布、使用、修改变量)：</a></li><li><a href="#_4-3-多个context使用例子">4.3 多个Context使用例子</a></li></ul></li><li><a href="#_5-setstate-说明">5. setState()说明</a><ul><li><a href="#_5-1-执行setstate-后this-state立即获取到更新方法">5.1 执行setState()后this.state立即获取到更新方法</a></li><li><a href="#_5-2-在setstate里面使用state的变量">5.2 在setState里面使用state的变量</a></li></ul></li><li><a href="#_6-无状态组件sfc">6. 无状态组件SFC</a></li><li><a href="#_7-purecomponent-纯组件">7. PureComponent 纯组件</a><ul><li><a href="#_7-1-原理">7.1 原理</a></li><li><a href="#_7-2-注意点">7.2 注意点</a></li></ul></li><li><a href="#_8-fragments-解决必须有一个根节点问题">8. Fragments:解决必须有一个根节点问题</a><ul><li><a href="#_8-1-fragments简写形式">8.1 Fragments简写形式&lt;&gt;&lt;/&gt;</a></li></ul></li><li><a href="#_9-react中dom元素">9 react中DOM元素</a><ul><li><a href="#_9-1-dangerouslysetinnerhtml">9.1 dangerouslySetInnerHTML</a></li></ul></li><li><a href="#_10-props-children-容器类组件、插槽">10. props.children(容器类组件、插槽)</a></li><li><a href="#_11-react-children：处理和转化props-children">11. React.Children：处理和转化props.children</a><ul><li><a href="#_11-1-children-count-统计子节点数量">11.1 Children.count 统计子节点数量</a></li><li><a href="#_11-2-遍历子节点">11.2 遍历子节点</a></li><li><a href="#_11-3-children-toarray-children-：将-children-转换成数组">11.3 Children.toArray(children)：将 children 转换成数组</a></li><li><a href="#_11-4-children-only-children-：断言children是react元素">11.4 Children.only(children)：断言children是React元素</a></li></ul></li><li><a href="#_12-react-children-替代方案">12 React.Children 替代方案</a><ul><li><a href="#_12-1-暴露多个组件">12.1 暴露多个组件</a></li><li><a href="#_21-2-接收对象数组作为参数">21.2 接收对象数组作为参数</a></li><li><a href="#_12-3-调用渲染属性以自定义渲染">12.3 调用渲染属性以自定义渲染</a></li></ul></li><li><a href="#_13-cloneelement克隆元素">13. cloneElement克隆元素</a></li><li><a href="#_14-函数和函数组件在jsx中区别">14. 函数和函数组件在JSX中区别</a></li><li><a href="#_15-react-memo">15. React.memo</a></li></ul></div><p></p> <p>[TOC]</p> <h1 id="react使用手册"><a href="#react使用手册" aria-hidden="true" class="header-anchor">#</a> react使用手册</h1> <h2 id="_1-react样式的写法"><a href="#_1-react样式的写法" aria-hidden="true" class="header-anchor">#</a> 1. react样式的写法</h2> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">var</span> HelloWorld <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
  render<span class="token punctuation">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
    <span class="token keyword">var</span> styles <span class="token operator">=</span> <span class="token punctuation">{</span>   color<span class="token punctuation">:</span> <span class="token string">'blue'</span><span class="token punctuation">,</span>  fontSize<span class="token punctuation">:</span> <span class="token string">'30'</span>  <span class="token punctuation">}</span>  
    <span class="token keyword">return</span> <span class="token punctuation">(</span>  
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">  
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span> 
          <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>color<span class="token punctuation">:</span><span class="token string">'red'</span><span class="token punctuation">,</span>backgroundColor<span class="token punctuation">:</span><span class="token string">'lime'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">默认标题</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">  
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>subtitle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>styles<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">说明</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">  
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>details<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">这个是用来教学的案例</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">  
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>  
    <span class="token punctuation">)</span>  
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">)</span>  
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HelloWorld</span><span class="token punctuation">/&gt;</span></span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;app&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
</code></pre></div><ul><li><p>JSX中使用样式</p> <p>1、行内样式：写行内样式的时候需要使用两个{}  ==&gt;{{}}</p> <p>2、对象样式：在return前面定义一个样式对象，注意样式的写法，与HTML的不同点</p> <p>3、CSS样式</p></li> <li><p>在HTML5中与在React中的样式的书写区别</p> <p>1、HTML5中以<code>;</code>结束，在React中以<code>,</code>结束</p> <p>2、在HTML5中属性与值都不需要加上引号。在React中，属于javascript对象，key中不能存在 <code>-</code>,需要使用驼峰命名，如果是value值，需要加上引号</p> <p>3、在HTML中，设置带数字的值，宽度，高度==，需要带上单位。在React中可以不用带单位，直接写数字 这里是指那些规定了默认单位的值。比如说像素px，如果要使用em或者是rem则需要加上单位</p></li> <li><p>其他注意事项</p> <p>在使用插值符号的时候，里面需要时一个对象或者是一个表达式</p></li></ul> <p>参考资料：https://blog.csdn.net/chuipaopao163/article/details/73432229</p> <h3 id="_1-1-jsx中根据条件显示特殊样式"><a href="#_1-1-jsx中根据条件显示特殊样式" aria-hidden="true" class="header-anchor">#</a> 1.1 JSX中根据条件显示特殊样式</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>menuIndex <span class="token operator">===</span> i <span class="token operator">?</span> <span class="token string">'active'</span> <span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>menuIndex <span class="token operator">===</span> i <span class="token operator">?</span> <span class="token string">'active button'</span> <span class="token punctuation">:</span> <span class="token string">'button'</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="_1-2-多个类样式根据不同条件来显示"><a href="#_1-2-多个类样式根据不同条件来显示" aria-hidden="true" class="header-anchor">#</a> 1.2 多个类样式根据不同条件来显示</h3> <p>可使用npm包工具来实现：<a href="https://www.npmjs.com/package/classnames" target="_blank" rel="noopener noreferrer">https://www.npmjs.com/package/classnames<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>或者自己根据条件来拼字符串：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// 参数是对象，对象的属性是类名，属性值判断是否加这个类名</span>
<span class="token function-variable function">setClassNames</span> <span class="token operator">=</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment">// 参数不是对象直接返回空不处理</span>
  <span class="token keyword">let</span> key<span class="token punctuation">;</span>
  <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> str <span class="token operator">+=</span> <span class="token string">' '</span> <span class="token operator">+</span> key<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment">// 如果对象属性值是true，则加上这个类</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> str<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span>
   <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setClassNames</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
       <span class="token string">'active'</span><span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">[</span>e<span class="token punctuation">.</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> item<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
       <span class="token string">'forbidden'</span><span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>dimensional <span class="token operator">===</span> e<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_2-生命周期（lifecycle）"><a href="#_2-生命周期（lifecycle）" aria-hidden="true" class="header-anchor">#</a> 2. 生命周期（Lifecycle）</h2> <p>https://segmentfault.com/a/1190000004168886</p> <p>https://segmentfault.com/a/1190000018490987</p> <p>React 的生命周期包括三个阶段：mount（挂载）、update（更新）和 unmount（移除）</p> <h3 id="_2-1-mount"><a href="#_2-1-mount" aria-hidden="true" class="header-anchor">#</a> 2.1 mount</h3> <p>mount 就是第一次让组件出现在页面中的过程。这个过程的关键就是 render 方法。React 会将 render 的返回值（一般是虚拟 DOM，也可以是 DOM 或者 null）插入到页面中。</p> <p>这个过程会暴露几个钩子（hook）方便你往里面加代码：</p> <ol><li>constructor()</li> <li>componentWillMount()</li> <li>render()</li> <li>componentDidMount()</li></ol> <p>我用一幅图解释一下：</p> <p><img src="http://cdn.jscode.me/2017-04-09-14916683117874.jpg" alt></p> <h3 id="_2-2-update"><a href="#_2-2-update" aria-hidden="true" class="header-anchor">#</a> 2.2 update</h3> <p>mount 之后，如果数据有任何变动，就会来到 update 过程，这个过程有 5 个钩子：</p> <ol><li><p>componentWillReceiveProps(nextProps) - 我要读取 props 啦！</p></li> <li><p>shouldComponentUpdate(nextProps, nextState) - 请问要不要更新组件？true / false</p></li> <li><p>componentWillUpdate() - 我要更新组件啦！</p></li> <li><p>render() - 更新！</p></li> <li><p>componentDidUpdate() - 更新完毕啦！</p></li></ol> <h3 id="_2-3-unmount"><a href="#_2-3-unmount" aria-hidden="true" class="header-anchor">#</a> 2.3 unmount</h3> <p>当一个组件将要从页面中移除时，会进入 unmount 过程，这个过程就一个钩子：</p> <ol><li>componentWillUnmount() - 我要死啦！</li></ol> <p>你可以在这个组件死之前做一些清理工作。</p> <h2 id="_3-ref的使用"><a href="#_3-ref的使用" aria-hidden="true" class="header-anchor">#</a> 3. ref的使用</h2> <p>ref是使用回调函数的方式去使用：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">Input</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">focus</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>textInput<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>textInput <span class="token operator">=</span> input <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>input</code>参数来源：</p> <p>当我们在DOM Element中使用<code>ref</code>时，回调函数将接收当前的DOM元素作为参数，然后存储一个指向这个DOM元素的引用。那么在示例代码中，我们已经把<code>input</code>元素存储在了<code>this.textInput</code>中，在<code>focus</code>函数中直接使用原生DOM API实现focus聚焦。</p> <p>父组件使用ref调用子组件方法:</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">getShowData</span> <span class="token operator">=</span> <span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'params '</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token punctuation">(</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">12312</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">father</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取子组件引用</span>
  <span class="token function-variable function">getRef</span> <span class="token operator">=</span> <span class="token punctuation">(</span>ele<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>incomeTable <span class="token operator">=</span> ele<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ele<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
      ele<span class="token punctuation">.</span><span class="token function">getShowData</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Son</span>  <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>getRef<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span> <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p>ref的回调函数执行时间</p> <p>当组件挂载后和卸载后，以及ref属性本身发生变化时，回调函数就会被调用。</p></li></ul> <p>可以在组件实例中使用<code>ref</code>：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// &lt;Input&gt;来源于上面的示例代码👆</span>
<span class="token keyword">class</span> <span class="token class-name">AutoFocusTextInput</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>textInput<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Input</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>textInput <span class="token operator">=</span> input <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    )
	}
}
</span></code></pre></div><p>当我们在<code>&lt;Input&gt;</code>中添加<code>ref</code>属性时，其回调函数接收已经挂载的组件实例<code>&lt;Input&gt;</code>作为参数，并通过<code>this.textInput</code>访问到其内部的<code>focus</code>方法。也就是说，上面的示例代码实现了当<code>AutoFocusTextInput</code>组件挂载后<code>&lt;Input&gt;</code>组件的自动聚焦。</p> <p>接下来文档指出，<code>&lt;Input&gt;</code>组件必须是使用<code>class</code>声明的组件，不然无法使用。这意味着React逐渐与ES6全面接轨了。</p> <p>父组件的ref回调函数可以使用子组件的DOM:</p> <p>这是Facebook非常不推荐的做法，因为这样会打破组件的封装性，这种方法只是某些特殊场景下的权宜之计。我们看看如何实现，上代码：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">CustomTextInput</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>inputRef<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>CustomTextInput</span> <span class="token attr-name">inputRef</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>el <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>inputElement <span class="token operator">=</span> el<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>原理就是父组件把<code>ref</code>的回调函数当做<code>inputRef</code>props传递给子组件，然后子组件<code>&lt;CustomTextInput&gt;</code>把这个函数和当前的DOM绑定，最终的结果是父组件<code>&lt;Parent&gt;</code>的<code>this.inputElement</code>存储的DOM是子组件<code>&lt;CustomTextInput&gt;</code>中的<code>input</code>。</p> <p>同样的道理，如果A组件是B组件的父组件，B组件是C组件的父组件，那么可用上面的方法，让A组件拿到C组件的DOM。但是官方态度是discouraged，这种多级调用确实不雅，我们确实需要考虑其他更好的方案了。</p> <p>参考资料：https://juejin.im/post/5927f51244d904006414925a</p> <h2 id="_4-context：组件间共享变量"><a href="#_4-context：组件间共享变量" aria-hidden="true" class="header-anchor">#</a> 4.Context：组件间共享变量</h2> <p>Context是react 16.0以上版本才支持的。</p> <p>在react中数据是通过props属性自上而下传递，当组件层级数量增多时，在每一层传递数据就变得很繁琐。Context提供了一种新的组件之间共享数据的方式，允许数据隔代传递，而不必显示的通过组件树逐层传递。</p> <p>使用方式：<br>
1、创建一个文件，所有用Context的组件都要引用这个文件，这个文件里面声明Context。<br>
2、共同的父组件里面使用<code>Provider</code>发布数据，子组件使用<code>Consumer</code>来使用数据<br>
3、函数组件还可以使用useContext hooks方法接收数据。类组件可以使用静态属性ContextType接收数据。<br>
4、子组件如果需要修改数据，在<code>Provider</code>里面传修改数据的方法。</p> <h3 id="_4-1-api说明"><a href="#_4-1-api说明" aria-hidden="true" class="header-anchor">#</a> 4.1 API说明</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token comment">// 1. 创建一个Context文件，所有地方都只能引入这一个文件{Provider, Consumer}</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> UserContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span>defaultValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 也可以用这个：export default React.createContext({});</span>

<span class="token comment">// 2. 设置变量，Provider接收一个 value 属性，这个变量就是Context用到的变量，所有用到的变量的组件都要包裹在Provider下面。</span>
<span class="token comment">// 要引入UserContext文件</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>UserContext.Provider</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> age<span class="token punctuation">,</span> setAge<span class="token punctuation">:</span> setAge <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Content</span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>UserContext.Provider</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">// 3. 使用变量：Consumer接收一个函数作为子节点函数接收当前 context 的值并返回一个 React 节点。传递给函数的 value 将等于组件树中上层 context 的最近的 Provider 的 value 属性。</span>
<span class="token comment">// 如果 context 没有 Provider ，那么 value 参数将等于被传递给 createContext() 的 defaultValue 。</span>
<span class="token comment">// 要引入UserContext文件</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>UserContext.Consumer</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span> value <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">名字：</span><span class="token punctuation">{</span>value<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token plain-text">，年龄：</span><span class="token punctuation">{</span>value<span class="token punctuation">.</span>age<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>UserContext.Consumer</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">// 4. 其他方式使用变量</span>
<span class="token comment">// 4.1 函数组件：使用React.useContext(UserContext)，具体看下面例子</span>
<span class="token comment">// 4.1 类组件：使用 contextType，具体看下面例子</span>
</code></pre></div><p>每当Provider的值发送改变时, 作为Provider后代的所有Consumers都会重新渲染。 从Provider到其后代的Consumers传播不受shouldComponentUpdate方法的约束，因此即使祖先组件退出更新时，后代Consumer也会被更新。</p> <p>通过使用与<a href="http://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is#Description" target="_blank" rel="noopener noreferrer">Object.is<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>相同的算法比较新值和旧值来确定变化。</p> <h3 id="_4-2-使用的例子-发布、使用、修改变量-："><a href="#_4-2-使用的例子-发布、使用、修改变量-：" aria-hidden="true" class="header-anchor">#</a> 4.2 使用的例子(发布、使用、修改变量)：</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// contextTest.js：定义一个context 文件，所有用到这个context的组件都要引用这个文件</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> UserContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 共同的父组件发布变量</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@views/contextTest.js'</span><span class="token punctuation">;</span> <span class="token comment">// 引入共同的 Context</span>
<span class="token keyword">const</span> <span class="token function-variable function">Content</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>UserInfo</span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 让子组件可以修改 Context</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>UserContext.Provider</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'Alice'</span><span class="token punctuation">,</span> age<span class="token punctuation">:</span> age<span class="token punctuation">,</span> setAge<span class="token punctuation">:</span> setAge <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Content</span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>UserContext.Provider</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 函数组件使用变量：1、通过useContext使用。2、通过Consumer使用</span>
<span class="token comment">// 修改变量可以通过给useContext 传方法，然后调用方法修改变量</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@views/contextTest.js'</span><span class="token punctuation">;</span> <span class="token comment">// 引入共同的 Context</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">UserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>UserContext<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1、通过useContext获取变量</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">用户名: </span><span class="token punctuation">{</span>user<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">年龄: </span><span class="token punctuation">{</span>user<span class="token punctuation">.</span>age<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>age <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">增加年龄</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>UserContext.Consumer</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span><span class="token comment">/* 2、通过Consumer获取变量 */</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token punctuation">{</span> value <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">名字：</span><span class="token punctuation">{</span>value<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token plain-text">，年龄：</span><span class="token punctuation">{</span>value<span class="token punctuation">.</span>age<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>UserContext.Consumer</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 类组件使用变量：1、通过contextType。2、通过Consumer使用(跟上面的函数组件一样，这里不写了)</span>
<span class="token comment">// class 上的 contextType 属性会被重赋值为一个由 React.createContext() 创建的 Context 对象。</span>
<span class="token comment">// 这能让你使用 this.context 来消费最近 Context 上的那个值。你可以在任何生命周期中访问到它，包括 render 函数中。</span>
<span class="token comment">// 如果你正在使用实验性的 public class fields 语法，你可以使用 static 这个类属性来初始化你的 contextType。</span>
<span class="token keyword">class</span> <span class="token class-name">UserInfo</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>PureComponent</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> contextType <span class="token operator">=</span> UserContext<span class="token punctuation">;</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用contexType可以在任意生命周期访问数据，使用 this.context 来消费最近 Context 上的那个值</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">name:</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token plain-text">age:</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>age<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-3-多个context使用例子"><a href="#_4-3-多个context使用例子" aria-hidden="true" class="header-anchor">#</a> 4.3 多个Context使用例子</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// 多个context 文件</span>
<span class="token keyword">const</span> SchoolContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'南师附中'</span><span class="token punctuation">,</span>
  location<span class="token punctuation">:</span> <span class="token string">'南京'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> StudentContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'chengzhu'</span><span class="token punctuation">,</span>
  age<span class="token punctuation">:</span> <span class="token number">17</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> SchoolContext<span class="token punctuation">,</span> StudentContext <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 共同父组件发布变量， 直接写调用的地方</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SchoolContext.Provider</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>school<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>StudentContext.Provider</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>student<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MiddlePage</span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>StudentContext.Provider</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SchoolContext.Provider</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">// 使用变量，直接写调用的地方</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SchoolContext.Consumer</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span>school <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>StudentContext.Consumer</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>student <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            学校: </span><span class="token punctuation">{</span>school<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token plain-text">，位置: </span><span class="token punctuation">{</span>school<span class="token punctuation">.</span>location<span class="token punctuation">}</span><span class="token plain-text">
            学生姓名: </span><span class="token punctuation">{</span>student<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token plain-text">，学生年龄: </span><span class="token punctuation">{</span>student<span class="token punctuation">.</span>age<span class="token punctuation">}</span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>StudentContext.Consumer</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>SchoolContext.Consumer</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>参考资料：https://blog.csdn.net/qq_34307801/article/details/109774612</p> <h2 id="_5-setstate-说明"><a href="#_5-setstate-说明" aria-hidden="true" class="header-anchor">#</a> 5. setState()说明</h2> <p><code>setState()</code>将对组件状态的改变排队，并告诉该组件及其子组件需要用已经更新的状态来重新渲染。这个方法主要是用来更新用户界面以响应事件处理和服务器响应。</p> <p>1、<code>setState()</code>不总是立刻更新组件。其可能是成批处理或推迟更新。这使得在调用<code>setState()</code>后立刻读取<code>this.state</code>变成一个潜在陷阱。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> tt<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'tt: '</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>tt<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> tt<span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'tt: '</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>tt<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>上面代码执行后，输出<code>50 50</code>, 说明方法合并到一起执行了</p> <p>2、<code>setState()</code>永远都会导致重新渲染，除非<code>shouldComponentUpdate()</code> 返回<code>false</code>。所以和渲染无关的状态不要放在state中。</p> <p>3、<code>setState()</code>的第二个参数是一个可选的回调函数，其执行将是在一旦<code>setState</code>完成，并且组件被重新渲染之后。通常，对于这类逻辑，我们推荐使用<code>componentDidUpdate</code>。</p> <p>由于使用setState()更新了值后，不会立刻就能使用<code>this.state</code>看到最新的值，如：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> context<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 第一次render后的生命周期</span>
<span class="token function">componentDidMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>tt<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'tt: '</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>tt<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 此时输出的是1</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-1-执行setstate-后this-state立即获取到更新方法"><a href="#_5-1-执行setstate-后this-state立即获取到更新方法" aria-hidden="true" class="header-anchor">#</a> 5.1 执行setState()后this.state立即获取到更新方法</h3> <p><code>setState()</code>的第二个参数是一个可选的回调函数，其执行将是在一旦<code>setState</code>完成，并且组件被重新渲染之后。可用如下方法：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">componentDidMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> tt<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// this.setState({tt: 30}, this.pp ) 此方法也可以</span>
<span class="token punctuation">}</span>
<span class="token function-variable function">pp</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'tt: '</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>tt<span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre></div><p>可以使用<strong>setTimeout</strong>异步函数来替代。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">componentDidMount</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>tt<span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>pp<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 40</span>
<span class="token punctuation">}</span>
<span class="token function-variable function">pp</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'tt: '</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>tt<span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre></div><p>或者把需要的实时的变量放到类变量里面：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> context<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span> value<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 直接把变量放在这里</span>
<span class="token punctuation">}</span>
</code></pre></div><p>参考资料：</p> <p>https://www.cnblogs.com/feiyu6/p/9202873.html</p> <p>https://react.docschina.org/docs/react-component.html#setstate</p> <h3 id="_5-2-在setstate里面使用state的变量"><a href="#_5-2-在setstate里面使用state的变量" aria-hidden="true" class="header-anchor">#</a> 5.2 在setState里面使用state的变量</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>prevState <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  collapsed<span class="token punctuation">:</span> <span class="token operator">!</span>prevState<span class="token punctuation">.</span>collapsed
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_6-无状态组件sfc"><a href="#_6-无状态组件sfc" aria-hidden="true" class="header-anchor">#</a> 6. 无状态组件SFC</h2> <p>无状态组件顾名思义就是没有状态的组件，如果一个组件不需要管理 state 只是纯的展示，那么就可以定义成无状态组件。无状态组件是在 React 在 v0.14 之后推出的</p> <p>无状态组件是没有 refs 属性的。</p> <p>无状态的函数创建的组件是无状态组件，它是一种只负责展示的纯组件：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">HelloComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Hello </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">}</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HelloComponent</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>marlon<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">,</span> mountNode<span class="token punctuation">)</span>
</code></pre></div><p>对于这种无状态的组件，使用函数式的方式声明，会使得代码的可读性更好，并能大大减少代码量，箭头函数则是函数式写法的最佳搭档：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token function-variable function">Todo</span> <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span>
    <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>onClick<span class="token punctuation">}</span></span>
    <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>textDecoration<span class="token punctuation">:</span> props<span class="token punctuation">.</span>complete <span class="token operator">?</span> <span class="token string">&quot;line-through&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
  <span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span>
</code></pre></div><p>上面定义的 <code>Todo</code> 组件，输入输出数据完全由<code>props</code>决定，而且不会产生任何副作用。对于<code>props</code>为 <code>Object</code> 类型时，我们还可以使用 ES6 的解构赋值：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> <span class="token function-variable function">Todo</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> onClick<span class="token punctuation">,</span> complete<span class="token punctuation">,</span> text<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span>
    <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onClick<span class="token punctuation">}</span></span>
    <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>textDecoration<span class="token punctuation">:</span> complete <span class="token operator">?</span> <span class="token string">&quot;line-through&quot;</span> <span class="token punctuation">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
    <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span>
  <span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span>
</code></pre></div><p><strong>优点</strong>：</p> <ul><li><p>适当减少代码量，可读性增强；</p></li> <li><p>无状态，统一移交给高阶组件（HOC）或者 Redux 进行管理；</p> <p>这种模式在大型项目或者组件中经常被使用，未来 React 也会对 SFC 做一些专门的优化；</p></li></ul> <p>这种模式被鼓励在大型项目中尽可能以简单的写法 来分割原本庞大的组件，而未来 React 也会面向这种无状态的组件进行一些专门的优化，比如避免无意义的检查或内存分配。所以建议大家尽可能在项目中使用无状态组件。</p> <p>无状态组件内部其实是可以使用<code>ref</code>功能的，虽然不能通过<code>this.refs</code>访问到，但是可以通过将<code>ref</code>内容保存到无状态组件内部的一个本地变量中获取到。</p> <p>例如下面这段代码可以使用<code>ref</code>来获取组件挂载到DOM中后所指向的DOM元素:</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">TestComp</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> ref<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> ref <span class="token operator">=</span> node<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>参考资料：</p> <p>https://www.w3cplus.com/react/stateful-vs-stateless-components.html</p> <h2 id="_7-purecomponent-纯组件"><a href="#_7-purecomponent-纯组件" aria-hidden="true" class="header-anchor">#</a> 7. PureComponent 纯组件</h2> <blockquote><p>PureComponent 的作用：用来提升性能，因为它减少了应用中的渲染次数。</p></blockquote> <p>React15.3 中新加了一个 <code>PureComponent</code> 类，它是优化 React 应用程序最重要的方法之一。</p> <p>在简单组件（纯展示组件）上的性能可以高出 <code>React.Component</code> 几十倍，所以性能还是很可观的~</p> <h3 id="_7-1-原理"><a href="#_7-1-原理" aria-hidden="true" class="header-anchor">#</a> 7.1 原理</h3> <p>当组件更新时，如果组件的 <code>props</code> 和 <code>state</code> 都没发生改变，<code>render</code> 方法就不会触发，省去 <strong>Virtual DOM</strong> 的「生成」和「比对」过程，达到提升性能的目的。</p> <p>React 做了如下判断：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_compositeType <span class="token operator">===</span> CompositeTypes<span class="token punctuation">.</span>PureClass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  shouldUpdate <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">shallowEqual</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> nextProps<span class="token punctuation">)</span>
  <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">shallowEqual</span><span class="token punctuation">(</span>inst<span class="token punctuation">.</span>state<span class="token punctuation">,</span> nextState<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这里的 <code>shallowEqual</code> 会比较 <code>Object.keys(state | props)</code> 的<strong>长度是否一致</strong>，每一个 <code>key</code> 是否<strong>两者都有</strong>，并且<strong>是否是一个引用</strong>，也就是只比较了<strong>第一层的值</strong>，确实很浅，所以深层的嵌套数据是对比不出来的。</p> <h3 id="_7-2-注意点"><a href="#_7-2-注意点" aria-hidden="true" class="header-anchor">#</a> 7.2 注意点</h3> <ol><li><p>如果 <code>PureComponent</code> 里有 <code>shouldComponentUpdate</code> 函数的话，React 会直接使用 shouldComponentUpdate 的结果作为是否更新的依据；</p> <p>只有<strong>不存在</strong> <code>shouldComponentUpdate</code> 函数，React 才会去判断是不是 <code>PureComponent</code>，是的话再去做 <code>shallowEqual</code> 浅比较。</p> <p>也因为可以少写 <code>shouldComponentUpdate</code> 函数，倒也节省了点代码。</p></li> <li><p>因为只做了浅比较，所以需要注意 state 或 props 中修改前后的对象引用是否一致；</p></li> <li><p>由于是 React15.3 之后才有的，所以可能需要进行兼容操作；</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token punctuation">{</span> PureComponent<span class="token punctuation">,</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token keyword">extends</span> <span class="token punctuation">(</span>PureComponent <span class="token operator">||</span> Component<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <p>参考资料：https://blog.lbinin.com/frontEnd/React/React-SFC.html</p> <p>react官网关于PureComponent组件介绍：https://zh-hans.reactjs.org/docs/react-api.html#reactpurecomponent</p> <h2 id="_8-fragments-解决必须有一个根节点问题"><a href="#_8-fragments-解决必须有一个根节点问题" aria-hidden="true" class="header-anchor">#</a> 8. Fragments:解决必须有一个根节点问题</h2> <p><code>&lt;React.Fragment&gt;</code>是为了解决<code>render</code>函数必须有一个跟节点问题。</p> <p>react版本15以前，<code>render</code>函数的返回必须有一个根节点，否则报错，为满足这一原则我会使用一个没有任何样式的 div 包裹一下。</p> <p>react版本16开始，render支持返回数据，这一特性已经可以减少不必要节点嵌套：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">一步 01</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">一步 02</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">一步 03</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果你不喜欢用数组，React 16为我们提供了Fragments：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>React.Fragment</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">一步 01</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">一步 02</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>React.Fragment</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_8-1-fragments简写形式"><a href="#_8-1-fragments简写形式" aria-hidden="true" class="header-anchor">#</a> 8.1 Fragments简写形式<code>&lt;&gt;&lt;/&gt;</code></h3> <p><code>&lt;&gt;&lt;/&gt;</code>形式，前有些前端工具*<strong>支持的还不太好*</strong>，用 create-react-app 创建的项目就不能通过编译</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">一步 01</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">一步 02</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_9-react中dom元素"><a href="#_9-react中dom元素" aria-hidden="true" class="header-anchor">#</a> 9 react中DOM元素</h2> <p>https://zh-hans.reactjs.org/docs/dom-elements.html</p> <p>React 实现了一套独立于浏览器的 DOM 系统，兼顾了性能和跨浏览器的兼容性。我们借此机会完善了浏览器 DOM 实现的一些特殊情况。</p> <p>在 React 中，所有的 DOM 特性和属性（包括事件处理）都应该是小驼峰命名的方式。例如，与 HTML 中的 <code>tabindex</code> 属性对应的 React 的属性是 <code>tabIndex</code>。例外的情况是 <code>aria-*</code> 以及 <code>data-*</code> 属性，一律使用小写字母命名。比如, 你依然可以用 <code>aria-label</code> 作为 <code>aria-label</code>。</p> <h3 id="_9-1-dangerouslysetinnerhtml"><a href="#_9-1-dangerouslysetinnerhtml" aria-hidden="true" class="header-anchor">#</a> 9.1 dangerouslySetInnerHTML</h3> <p>使用代码直接设置 HTML 存在风险，因为很容易无意中使用户暴露于<a href="https://en.wikipedia.org/wiki/Cross-site_scripting" target="_blank" rel="noopener noreferrer">跨站脚本（XSS）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的攻击。</p> <p>在react中html字符串不会渲染成真正的html，也不会执行脚本文件。</p> <p><code>dangerouslySetInnerHTML</code> 是 React 为浏览器 DOM 提供 <code>innerHTML</code> 的替换方案。当你想设置 <code>dangerouslySetInnerHTML</code> 时，需要向其传递包含 key 为 <code>__html</code> 的对象，以此来警示：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token function-variable function">replaceHtml</span> <span class="token operator">=</span> <span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
  <span class="token comment">// return &lt;div dangerouslySetInnerHTML={createMarkup()} /&gt;;</span>
  <span class="token comment">// &lt;div dangerouslySetInnerHTML={{ __html: '&lt;div&gt;123&lt;/div&gt;' }} /&gt;</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">dangerouslySetInnerHTML</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>__html<span class="token punctuation">:</span><span class="token function">replaceHtml</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>process<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token punctuation">}</span>
</code></pre></div><p>1、dangerouslySetInnerHTMl 是React标签的一个属性。2、有2个{{}}，第一{}代表jsx语法开始，第二个是代表dangerouslySetInnerHTML接收的是一个对象键值对。3、.既可以插入DOM，又可以插入字符串。</p> <h2 id="_10-props-children-容器类组件、插槽"><a href="#_10-props-children-容器类组件、插槽" aria-hidden="true" class="header-anchor">#</a> 10. props.children(容器类组件、插槽)</h2> <p>在编写html页面的时候，标签嵌套是很常见的。有时候你会希望以同样的方式嵌套自己开发的组件。当组件标签有子节点时，组件将在名为 <code>children</code> 的 props 中接收到该内容。</p> <p><strong>children 属性</strong>：表示组件标签的子节点。children 属性与普通的props一样，可以是任意值（文本、JSX、组件，甚至是函数）</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">ListItem</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 当函数执行，需要加判断</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token comment">/* 当写了子组件， 那么props.children的值就是子组件，手动传的children属性无效*/</span><span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ListItem</span> <span class="token attr-name">children</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>手写的<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  普通文本
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">标签</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'函数'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ListItem</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><code>props.children</code> 就可以获得组件的子节点，有以下几种情况：<br>
1、组件没有子节点，<code>props.children</code> 类型为 undefined；<br>
2、组件有一个子节点，<code>props.children</code> 类型为 子节点的类型(原始类型、对象、函数等)；<br>
3、组件有多个子节点，<code>props.children</code> 类型为 array。</p> <p>注意：JSX将会自动删除<code>每行开头和结尾</code>的<code>空格</code>，以及空行。它还会把<code>字符串中间</code>的<code>空白行</code>压缩为一个空格。以下的这些例子都会渲染出一样的情况：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Grid</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Hello world!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Grid</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Grid</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  
  Hello
  
  world!
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Grid</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>为什么 children 属性并不总是一个数组？</p> <p>在 React 中，<code>children</code> 属性是被视为 <strong>不透明的</strong> 数据结构。这意味着你不应该依赖它的结构。如果要转换，过滤，或者统计子节点，你应该使用 <code>React.Children</code> 方法。</p> <p>实际操作过程中，<code>children</code> 在底层常常被表示为数组。但是如果这里只有一个子节点，那么 React 将不会创建数组，因为这将导致不必要的内存开销。只要你使用 <code>React.Children</code> 方法而不是直接操作 <code>children</code> 底层结构，即使 React 改变了 <code>children</code> 数据结构的实际实现方式，你的代码也不会被中断。</p> <p>当 <code>children</code> 是一个数组时，<code>Children.map</code> 会有许多有用的特性。比如，<code>Children.map</code> 将被返回元素上的 <a href="https://zh-hans.react.dev/learn/rendering-lists#keeping-list-items-in-order-with-key" target="_blank" rel="noopener noreferrer">key<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 你传递给它的 <code>children</code> 上的 key 绑定。这保证了原本的 JSX 子元素不会“丢失” key，即使它们上面的例子中那样被包裹。</p> <h2 id="_11-react-children：处理和转化props-children"><a href="#_11-react-children：处理和转化props-children" aria-hidden="true" class="header-anchor">#</a> 11. React.Children：处理和转化props.children</h2> <p>由于 props.children 可以是任何类型，比如原始类型、数组、函数、对象等等。因此React提供了一系列的函数助手来使得操作children更加方便。</p> <p>官方文档地址：https://zh-hans.react.dev/reference/react/Children</p> <p><strong>注意</strong>：使用 <code>Children</code> 的场景并不常见，使用它可能会削弱代码的健壮性。<a href="https://zh-hans.react.dev/reference/react/Children#alternatives" target="_blank" rel="noopener noreferrer">查看常见的替代方案<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <ul><li><a href="https://zh-hans.react.dev/reference/react/Children#children-count" target="_blank" rel="noopener noreferrer">Children.count(children)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：获取 <code>children</code> 中的节点数量</li> <li><a href="https://zh-hans.react.dev/reference/react/Children#children-foreach" target="_blank" rel="noopener noreferrer">Children.forEach(children, fn, thisArg?)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：遍历 <code>children</code> 中的节点</li> <li><a href="https://zh-hans.react.dev/reference/react/Children#children-map" target="_blank" rel="noopener noreferrer">Children.map(children, fn, thisArg?)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：遍历 <code>children</code> 中的节点，返回新的处理后的节点</li> <li><a href="https://zh-hans.react.dev/reference/react/Children#children-only" target="_blank" rel="noopener noreferrer">Children.only(children)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：断言 <code>children</code> 代表一个 React 元素</li> <li><a href="https://zh-hans.react.dev/reference/react/Children#children-toarray" target="_blank" rel="noopener noreferrer">Children.toArray(children)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：将 <code>children</code> 转换成数组</li></ul> <h3 id="_11-1-children-count-统计子节点数量"><a href="#_11-1-children-count-统计子节点数量" aria-hidden="true" class="header-anchor">#</a> 11.1 Children.count 统计子节点数量</h3> <p>因为<code>this.props.children</code> 可以是任何类型的，检查一个组件有多少个children是非常困难的。而片面的使用this.props.children.length时, 当传入的是字符串或者函数时，不会得到想要的结果，比如有个child：<code>&quot;Hello World!&quot;</code> ，但是使用 <code>.length</code> 的方法将会显示为12。</p> <p>这就是为什么我们有 <code>React.Children.count</code> 方法的原因。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">ChildrenCounter</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">React.Children.count(this.props.children)</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ChildrenCounter</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span><span class="token comment">/* 1个 */</span><span class="token punctuation">}</span><span class="token plain-text">
  Second!
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ChildrenCounter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ChildrenCounter</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span><span class="token comment">/* 2个 */</span><span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">First</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ChildComponent</span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ChildrenCounter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ChildrenCounter</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span><span class="token comment">/* 2个, 函数不统计，实测结果 */</span><span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">First!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text">
  Second!
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Third!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ChildrenCounter</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>注意</strong>：空节点（<code>null</code>，<code>undefined</code> 以及布尔值），字符串，数字和 <a href="https://zh-hans.react.dev/reference/react/createElement" target="_blank" rel="noopener noreferrer">React 元素<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 都会被统计为一个节点。<strong>在遍历统计的过程中，React 元素不会被渲染，所以其子节点不会被统计</strong>。 <a href="https://zh-hans.react.dev/reference/react/Fragment" target="_blank" rel="noopener noreferrer">Fragment<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 也不会被统计。函数不统计。对于数组，它本身也不会被统计，但其中的元素遵循上述规则。</p> <h3 id="_11-2-遍历子节点"><a href="#_11-2-遍历子节点" aria-hidden="true" class="header-anchor">#</a> 11.2 遍历子节点</h3> <p>遍历处理子节点方法 <code>React.Children.map</code> 和 <code>React.Children.forEach</code> 。它们在对应数组的情况下能起作用，除此之外，当函数、对象或者任何东西作为children传递时，它们也会起作用。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">IgnoreFirstChild</span><span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token punctuation">{</span>React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">(</span>child<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 忽略第一个元素</span>
      <span class="token keyword">return</span> child<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token comment">/* 使用 */</span><span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IgnoreFirstChild</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ListItem</span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text"> </span><span class="token punctuation">{</span><span class="token comment">/* 忽略这个元素 */</span><span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Third!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>IgnoreFirstChild</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>上面的例子，我们也可以使用children.map方法。但是如果将一个函数作为child传递过来。children就会变成一个函数而不是数组，由于函数没有map方法，所以会导致报错。而使用 <code>React.Children.map</code> 函数，无论什么都不会报错。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>IgnoreFirstChild</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">First!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token punctuation">{</span><span class="token comment">/* React.Children 会忽略这个函数 */</span><span class="token punctuation">}</span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>IgnoreFirstChild</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>map、forEach参数说明(children, fn, thisArg?)：</p> <ul><li><code>children</code>：组件接收到的 <a href="https://zh-hans.react.dev/learn/passing-props-to-a-component#passing-jsx-as-children" target="_blank" rel="noopener noreferrer"><code>children</code> 属性<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</li> <li><code>fn</code>：和 <a href="https://zh-hans.react.dev/(https:/developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach)" target="_blank" rel="noopener noreferrer">数组的 <code>forEach</code> 方法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 中的回调类似，是你希望为每个子节点执行的函数。当这个函数执行时，对应的子节点和其下标将分别作为函数的第一、第二个参数，下标从 <code>0</code> 开始自增。</li> <li><strong>可选</strong> <code>thisArg</code>：为 <code>fn</code> 函数绑定 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this" target="_blank" rel="noopener noreferrer"><code>this</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。默认值为 <code>undefined</code>。</li></ul> <p>返回值：</p> <ul><li>forEach 返回值： <code>undefined</code>。</li> <li>map返回值：如果 <code>children</code> 是 <code>null</code> 或者 <code>undefined</code>，那么就返回这个值。否则就返回一个由 <code>fn</code> 函数返回节点组成的一维数组。这个数组将包含除 <code>null</code> 和 <code>undefined</code> 以外的所有节点。</li></ul> <p>注意事项</p> <ul><li>空节点（<code>null</code>，<code>undefined</code> 以及布尔值），字符串，数字和 <a href="https://zh-hans.react.dev/reference/react/createElement" target="_blank" rel="noopener noreferrer">React 元素<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 都会被统计为单个节点。<strong>在遍历统计的过程中，React 元素不会被渲染，所以其子节点不会被统计</strong>。<a href="https://zh-hans.react.dev/reference/react/Fragment" target="_blank" rel="noopener noreferrer">Fragment<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 也不会被统计。对于数组，它本身也不会被统计，但其中的元素遵循上述规则。</li> <li>如果你在 <code>fn</code> 中返回了一个具有 key 的元素或者元素数组，<strong>各个元素的 key 将自动与其在 <code>children</code> 中对应的原始项的 key 绑定</strong>。当你在 <code>fn</code> 中返回了一个包含了多个元素的数组时，其中的每个元素的 key 都需要保证在这个数组中是独一无二的。</li></ul> <h3 id="_11-3-children-toarray-children-：将-children-转换成数组"><a href="#_11-3-children-toarray-children-：将-children-转换成数组" aria-hidden="true" class="header-anchor">#</a> 11.3 Children.toArray(children)：将 <code>children</code> 转换成数组</h3> <p>如果以上的方法你都不适合，你能将children转换为数组通过 <code>React.Children.toArray</code> 方法。如果你需要对它们进行排序，这个方法是非常有用的。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">class</span> Sort <span class="token keyword">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>
  render<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    const children <span class="token operator">=</span> React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span>toArray<span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token generics function"><span class="token punctuation">&lt;</span>p<span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>children<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span> <span class="token comment">// 对子元素排序渲染</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token generics function"><span class="token punctuation">&lt;</span>Sort<span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">{</span><span class="token comment">/* 我们使用表达式容器来确保我们的字符串，作为三个子字符串传递，而不是作为一个字符串传递  */</span><span class="token punctuation">}</span>
  <span class="token punctuation">{</span><span class="token string">'bananas'</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token string">'oranges'</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token string">'apples'</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Sort<span class="token operator">&gt;</span>
</code></pre></div><p>上例会渲染为三个排好序的字符串。</p> <h3 id="_11-4-children-only-children-：断言children是react元素"><a href="#_11-4-children-only-children-：断言children是react元素" aria-hidden="true" class="header-anchor">#</a> 11.4 Children.only(children)：断言children是React元素</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> element <span class="token operator">=</span> Children<span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>参数</p> <ul><li><code>children</code>：组件接收到的 <a href="https://zh-hans.react.dev/learn/passing-props-to-a-component#passing-jsx-as-children" target="_blank" rel="noopener noreferrer"><code>children</code> 属性<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</li></ul> <p>返回值</p> <p>如果 <code>children</code> <a href="https://zh-hans.react.dev/reference/react/isValidElement" target="_blank" rel="noopener noreferrer">是一个合法的元素<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，那么就会返回这个元素。否则会抛出一个异常。</p> <p>注意事项</p> <ul><li>如果传入一个数组（比如 <code>Children.map</code> 的返回值）作为 <code>children</code>，那么这个方法会抛出异常。也就是说，这个方法强制要求 <code>children</code> 是一个 React 元素，而不是一个元素数组。</li></ul> <h2 id="_12-react-children-替代方案"><a href="#_12-react-children-替代方案" aria-hidden="true" class="header-anchor">#</a> 12 React.Children 替代方案</h2> <p>使用 <code>Children</code> 方法操作子节点通常会削弱代码的健壮性。在 JSX 中将子节点传递给组件时，通常不希望操作或转换子节点。如果能够的话，尽量避免使用 <code>Children</code> 方法。</p> <h3 id="_12-1-暴露多个组件"><a href="#_12-1-暴露多个组件" aria-hidden="true" class="header-anchor">#</a> 12.1 暴露多个组件</h3> <p>如果你希望 <code>RowList</code> 的每一个子节点都被 <code>&lt;div className=&quot;Row&quot;&gt;</code> 包裹，那么可以导出一个 <code>Row</code> 组件，然后像下面这样手动把包裹每一行：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">RowList</span><span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>RowList<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"> 1</span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">Row</span><span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Row<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RowList</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Row</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">这是第一项。</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Row</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Row</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">这是第二项。</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Row</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Row</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">这是第三项。</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Row</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RowList</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>和使用 <code>Children.map</code> 不同，这种方式不会自动包裹每个子节点。但是，和 <a href="https://zh-hans.react.dev/reference/react/Children#transforming-children" target="_blank" rel="noopener noreferrer">上文中关于 <code>Children.map</code> 例子<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 相比，这种方式具有明显的优势，因为即使你继续抽离更多的组件，它也仍然有效。</p> <h3 id="_21-2-接收对象数组作为参数"><a href="#_21-2-接收对象数组作为参数" aria-hidden="true" class="header-anchor">#</a> 21.2 接收对象数组作为参数</h3> <p>你也可以显示地传递一个数组作为组件的参数。例如，下面的 <code>RowList</code> 接收了一个 <code>rows</code> 数组作为组件的参数，因为 <code>rows</code> 是一个常规的 JavaScript 数组，<code>RowList</code> 组件可以对其使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/map" target="_blank" rel="noopener noreferrer"><code>map</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 等数组内置方法。：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">RowList</span><span class="token punctuation">(</span><span class="token punctuation">{</span> rows <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>RowList<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>rows<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>row <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>Row<span class="token punctuation">&quot;</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>row<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span>row<span class="token punctuation">.</span>content<span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RowList</span> <span class="token attr-name">rows</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token string">'first'</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">这是第一项。</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token string">'second'</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">这是第二项。</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token string">'third'</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">这是第三项。</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>和将子节点作为 JSX 传递不同，这个方法允许你将一些额外的数据，比如 <code>header</code>，与每个子项关联。因为你直接使用 <code>tabs</code>，并且它是一个数组，所以你并不需要 <code>Children</code> 方法。</p> <h3 id="_12-3-调用渲染属性以自定义渲染"><a href="#_12-3-调用渲染属性以自定义渲染" aria-hidden="true" class="header-anchor">#</a> 12.3 调用渲染属性以自定义渲染</h3> <p>除了为每一个子项生成 JSX，你还可以传递一个返回值类型是 JSX 的函数，并且在必要的时候调用这个函数。在这个示例中，<code>App</code> 组件向 <code>TabSwitcher</code> 组件传递了一个 <code>renderContent</code> 函数。<code>TabSwitcher</code> 组件仅对被选中的 tab 调用 <code>renderContent</code>。</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">TabSwitcher</span><span class="token punctuation">(</span><span class="token punctuation">{</span> tabIds<span class="token punctuation">,</span> getHeader<span class="token punctuation">,</span> renderContent <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>selectedId<span class="token punctuation">,</span> setSelectedId<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span>tabIds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>tabIds<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>tabId <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>tabId<span class="token punctuation">}</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setSelectedId</span><span class="token punctuation">(</span>tabId<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token punctuation">{</span><span class="token function">getHeader</span><span class="token punctuation">(</span>tabId<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>selectedId<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token function">getHeader</span><span class="token punctuation">(</span>selectedId<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token function">renderContent</span><span class="token punctuation">(</span>selectedId<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TabSwitcher</span>
      <span class="token attr-name">tabIds</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token string">'first'</span><span class="token punctuation">,</span> <span class="token string">'second'</span><span class="token punctuation">,</span> <span class="token string">'third'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>
      <span class="token attr-name">getHeader</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>tabId <span class="token operator">=&gt;</span> tabId<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> tabId<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
      <span class="token attr-name">renderContent</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>tabId <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">This is the </span><span class="token punctuation">{</span>tabId<span class="token punctuation">}</span><span class="token plain-text"> item.</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">}</span></span>
    <span class="token punctuation">/&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这是如何在不操纵子组件的情况下，父组件和子组件进行协作的另一个示例。</p> <h2 id="_13-cloneelement克隆元素"><a href="#_13-cloneelement克隆元素" aria-hidden="true" class="header-anchor">#</a> 13. cloneElement克隆元素</h2> <p>cloneElement 官方文档：https://zh-hans.react.dev/reference/react/cloneElement</p> <p>使用方式：cloneElement(element, props, ...children)</p> <p>说明：调用 <code>cloneElement</code> 方法会基于 <code>element</code> 创建一个新的 React 元素，但新元素具有不同的 <code>props</code> 和 <code>children</code></p> <p>参数</p> <ul><li><code>element</code>：<code>element</code> 参数必须是一个有效的 React 元素。例如，它可以是一个类似 <code>&lt;Something /&gt;</code> 这样的 JSX 节点，也可以是 <a href="https://zh-hans.react.dev/reference/react/createElement" target="_blank" rel="noopener noreferrer"><code>createElement</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 调用的结果，或者也可以是另一个 <code>cloneElement</code> 调用的结果。</li> <li><code>props</code>：<code>props</code> 参数必须是一个对象或 <code>null</code>。如果传 <code>null</code>，克隆后的元素将保留所有原始的 <code>element.props</code>。否则，对于 <code>props</code> 对象中的每个 prop 属性，返回的元素将“优先”使用 <code>props</code> 中的值而不是 <code>element.props</code> 中的值。其余的 props 将从原始的 <code>element.props</code> 中填充。如果你传递 <code>props.key</code> 或者 <code>props.ref</code>，它们将替换原来的。</li> <li><strong>可选</strong> <code>...children</code>：零个或多个子节点。它们可以是任何 React 节点，包括 React 元素、字符串、数字、<a href="https://zh-hans.react.dev/reference/react-dom/createPortal" target="_blank" rel="noopener noreferrer">portals<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>、空节点（<code>null</code>、<code>undefined</code>、<code>true</code> 和 <code>false</code>），和 React 元素数组。如果你不传递任何 <code>...children</code> 参数，则原始的 <code>element.props.children</code> 将被保留。</li></ul> <p>返回值</p> <p><code>cloneElement</code> 返回一个具有一些属性的 React element 对象：</p> <ul><li><code>type</code>：与 <code>element.type</code> 相同。</li> <li><code>props</code>：将 <code>element.props</code> 与你传递的 <code>props</code> 浅合并的结果。</li> <li><code>ref</code>：原始的 <code>element.ref</code>，除非它被 <code>props.ref</code> 覆盖。</li> <li><code>key</code>：原始的 <code>element.key</code>，除非它被 <code>props.key</code> 覆盖。</li></ul> <p>通常，你将从组件返回该元素或使其成为另一个元素的子元素。尽管你可以读取元素的属性，但最好在创建每个元素后将其视为不透明的，并且仅渲染它。</p> <p>使用例子：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">Father</span><span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">'jack'</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    父组件，引入的子组件</span><span class="token punctuation">{</span>React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> name <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">Show</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">我是子组件 名字：</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token plain-text">, 年龄：</span><span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Father</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Show</span> <span class="token attr-name">age</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>18<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Father</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>用法：覆盖元素的 props</p> <p>想象一个 <code>List</code> 组件将其 <a href="https://zh-hans.react.dev/learn/passing-props-to-a-component#passing-jsx-as-children" target="_blank" rel="noopener noreferrer"><code>children</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 渲染为可选择行的列表，并带有可更改的“下一步”按钮选择了哪一行。<code>List</code> 组件需要以不同的方式渲染所选的 <code>Row</code>，因此它克隆它收到的每个 <code>&lt;Row&gt;</code> 子级，并添加额外的 <code>isHighlighted: true</code> 或 <code>isHighlighted: false</code> 属性。则可以使用克隆元素。具体例子参考官方文档。</p> <h2 id="_14-函数和函数组件在jsx中区别"><a href="#_14-函数和函数组件在jsx中区别" aria-hidden="true" class="header-anchor">#</a> 14. 函数和函数组件在JSX中区别</h2> <p>由于函数组件在JSX中既可以当组件用，也可以当函数调用。但是会有一些细微的差别。</p> <p>首先关于函数和函数组件的区别：<br>
1、函数组件：用函数描述的组件，本质上还是一个组件。因此它可以：使用hooks、拥有自己的状态、使用memo缓存上次渲染；在devtools里显示为组件、设置displayName；渲染可中断、可恢复；有自己的生命周期。<br>
2、函数：返回值为JSX的函数仅仅是代码片段的复用而已，相当于直接在写JSX。</p> <p>在实际使用中会发现：<br>
1、函数当组件用：在类组件和函数组件中都没问题。<br>
2、无hooks函数当函数执行：在类组件和函数组件中都没问题。<br>
3、有hooks函数当函数执行：在类组件中会报错，在函数组件中没问题</p> <p>有hooks的函数在 函数组件中当函数执行：<br>
1、函数中的hooks依旧有效，但是也会触发父组件的hooks，首先执行父组件中的hooks，然后在执行函数中的hooks。<br>
2、如果调用了多次函数，每个函数里面触发的hooks，其他的函数组件里面的hooks也会触发。首先是父组件hooks执行，然后在按照函数代码顺序依次执行每个函数的hooks。</p> <p><strong>注意</strong>：由于函数和函数组件的区别，在代码拆分的时候，一定要注意，有的地方只能拆分成JSX形式，也就是只能是使用执行函数。比如form表单子项，需要自定绑定输入框之类的JSX元素，如果在代码拆分的时候变成了组件，那么就会失去对输入框的控制，导致form表单不能自动更新至和自动校验了。</p> <p>下面是测试代码：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">ShowName</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 有hooks状态的函数</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> name:`</span></span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> o`</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>id<span class="token punctuation">}</span><span class="token plain-text"> name</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">ShowAge</span><span class="token punctuation">(</span><span class="token punctuation">{</span> age <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 无状态的纯函数</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 在类组件中测试</span>
<span class="token keyword">class</span> <span class="token class-name">Home</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ShowName</span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token comment">/* {ShowName()} */</span><span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token punctuation">{</span><span class="token comment">/* 执行有hooks的函数会报错：Uncaught Error: Invalid hook call. Hooks can only be called inside of the body of a function component. */</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ShowAge</span> <span class="token attr-name">age</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">18</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span><span class="token function">ShowAge</span><span class="token punctuation">(</span><span class="token punctuation">{</span> age<span class="token punctuation">:</span> <span class="token number">19</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 在函数组件中测试</span>
<span class="token keyword">function</span> <span class="token function">People</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'父 useEffect'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ShowName</span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token punctuation">{</span><span class="token function">ShowName</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token string">'one'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token punctuation">{</span><span class="token function">ShowName</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token string">'two'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ShowAge</span> <span class="token attr-name">age</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">18</span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token punctuation">{</span><span class="token function">ShowAge</span><span class="token punctuation">(</span><span class="token punctuation">{</span> age<span class="token punctuation">:</span> <span class="token number">19</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_15-react-memo"><a href="#_15-react-memo" aria-hidden="true" class="header-anchor">#</a> 15. React.memo</h2> <p>组件中状态（State）发生改变会导致该组件重新渲染，其中的子组件也会被重新渲染。如果子组件中并未使用该状态（State），重复渲染会导致无效的性能损耗。</p> <p>在阻止重新渲染这个需求的基础上，诞生了memo函数，memo是react的一种缓存技术，这个函数可以检测从父组件接收的props,并且在父组件改变state的时候比对这个state是否是本组件在使用，如果不是，则不会重新渲染子组件。</p> <p><strong>注意</strong>： memo React 16.6.0版本出现的，只有版本高于这个才能使用</p> <p>基本使用：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> SomeComponent <span class="token operator">=</span> <span class="token function">memo</span><span class="token punctuation">(</span>Component<span class="token punctuation">,</span> arePropsEqual<span class="token operator">?</span><span class="token punctuation">)</span>
</code></pre></div><ul><li>Component：要进行记忆化的组件。<code>memo</code> 不会修改该组件，而是返回一个新的、记忆化的组件。它接受任何有效的 React 组件，包括函数组件和 <a href="https://zh-hans.react.dev/reference/react/forwardRef" target="_blank" rel="noopener noreferrer"><code>forwardRef</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 组件。</li> <li>arePropsEqual：<strong>可选参数</strong>，一个函数，接受两个参数：组件的前一个 props 和新的 props。如果旧的和新的 props 相等，即组件使用新的 props 渲染的输出和表现与旧的 props 完全相同，则它应该返回 <code>true</code>。否则返回 <code>false</code>。通常情况下，你不需要指定此函数。默认情况下，React 将使用 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/is" target="_blank" rel="noopener noreferrer"><code>Object.is</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 比较每个 prop。</li> <li>返回值：<code>memo</code> 返回一个新的 React 组件。它的行为与提供给 <code>memo</code> 的组件相同，只是当它的父组件重新渲染时 React 不会总是重新渲染它，除非它的 props 发生了变化。</li></ul> <p>测试例子：</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Head</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Head,</span><span class="token punctuation">{</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> HeadOne <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">memo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">HeadOne,</span><span class="token punctuation">{</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">show</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">App count=</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">添加</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Head</span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HeadOne</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>jack<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HeadOne</span> <span class="token attr-name">list</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>list<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HeadOne</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>show<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 类组件中，由于this在类存在期间不会变，所以绑定到this上的变量和方法不会变，当props属性传给子组件，值不变不会触发子组件渲染</span>
<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>PureComponent</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span> count<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token function-variable function">show</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> count <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">App11 count=</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> count<span class="token punctuation">:</span> count <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">添加</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HeadOne</span> <span class="token attr-name">list</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>HeadOne</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>show<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>经过上面例子可以发现：<br>
1、正常的组件，每次父组件渲染，即使没有传props，子组件都会渲染。<br>
2、使用memo后，如果props没有修改，父组件渲染，子组件不会渲染。<br>
3、父组件是函数组件：每次渲染，使用const声明的变量和函数都是新创建的，即使值没有变。传到子组件中依然是不同的props，还是会导致子组件重新渲染。可以使用可以使用 useMemo  方法包裹缓存变量。<br>
4、父组件是类组件：使用this变量和组件内的方法每次都是不变的。没有函数组件的问题。</p> <p>memo 官方文档：https://zh-hans.react.dev/reference/react/memo</p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/yulilong/front-end-doc/edit/master/doc/react/002-react使用手册.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">12/12/2024, 11:12:33 AM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/201.60704fe0.js" defer></script><script src="/assets/js/app.2afb8482.js" defer></script>
  </body>
</html>

<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Number运算精度和大数显示问题 | 前端知识</title>
    <meta name="description" content="一个总结前端知识的文档网站">
    <link rel="icon" href="/logo.png">
  <script defer="defer" src="/static/jquery.slim.min.js"></script>
  <script defer="defer" src="/static/jquery.fancybox.min.js"></script>
  <link defer="defer" rel="stylesheet" type="text/css" href="/static/jquery.fancybox.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.76f153c4.css" as="style"><link rel="preload" href="/assets/js/app.488c6ca2.js" as="script"><link rel="preload" href="/assets/js/21.149e4329.js" as="script"><link rel="prefetch" href="/assets/js/10.fcc2aa4e.js"><link rel="prefetch" href="/assets/js/100.ac9e2cee.js"><link rel="prefetch" href="/assets/js/101.4d84add3.js"><link rel="prefetch" href="/assets/js/102.0f3836ba.js"><link rel="prefetch" href="/assets/js/103.5c1b38ae.js"><link rel="prefetch" href="/assets/js/104.d16a6024.js"><link rel="prefetch" href="/assets/js/105.c7f2dbf8.js"><link rel="prefetch" href="/assets/js/106.4c7831d8.js"><link rel="prefetch" href="/assets/js/107.9ba54cc7.js"><link rel="prefetch" href="/assets/js/108.6566aead.js"><link rel="prefetch" href="/assets/js/109.fea32e3b.js"><link rel="prefetch" href="/assets/js/11.18d3fa16.js"><link rel="prefetch" href="/assets/js/110.c347cb80.js"><link rel="prefetch" href="/assets/js/111.13bbcc83.js"><link rel="prefetch" href="/assets/js/112.e16bc7da.js"><link rel="prefetch" href="/assets/js/113.8c3ec16b.js"><link rel="prefetch" href="/assets/js/114.9d67504e.js"><link rel="prefetch" href="/assets/js/115.d9dc980e.js"><link rel="prefetch" href="/assets/js/116.cceda218.js"><link rel="prefetch" href="/assets/js/117.04c70cb1.js"><link rel="prefetch" href="/assets/js/118.21971819.js"><link rel="prefetch" href="/assets/js/119.0f3e035f.js"><link rel="prefetch" href="/assets/js/12.0313b74c.js"><link rel="prefetch" href="/assets/js/120.81681a17.js"><link rel="prefetch" href="/assets/js/121.c8a896d0.js"><link rel="prefetch" href="/assets/js/122.d653cfea.js"><link rel="prefetch" href="/assets/js/123.0a4fd0ed.js"><link rel="prefetch" href="/assets/js/124.2c706e1a.js"><link rel="prefetch" href="/assets/js/125.e3c36a6b.js"><link rel="prefetch" href="/assets/js/126.8daaa383.js"><link rel="prefetch" href="/assets/js/127.1373621a.js"><link rel="prefetch" href="/assets/js/128.0ac7f0b7.js"><link rel="prefetch" href="/assets/js/129.315e3350.js"><link rel="prefetch" href="/assets/js/13.d4c98bc3.js"><link rel="prefetch" href="/assets/js/130.ac9f1b4d.js"><link rel="prefetch" href="/assets/js/131.d57bb123.js"><link rel="prefetch" href="/assets/js/132.bad929f2.js"><link rel="prefetch" href="/assets/js/133.927b5f48.js"><link rel="prefetch" href="/assets/js/134.603065a6.js"><link rel="prefetch" href="/assets/js/135.6e072766.js"><link rel="prefetch" href="/assets/js/136.d666aab8.js"><link rel="prefetch" href="/assets/js/137.da2870ad.js"><link rel="prefetch" href="/assets/js/138.70c637b2.js"><link rel="prefetch" href="/assets/js/139.3c06b77e.js"><link rel="prefetch" href="/assets/js/14.d2661fef.js"><link rel="prefetch" href="/assets/js/140.09addeac.js"><link rel="prefetch" href="/assets/js/141.3401888e.js"><link rel="prefetch" href="/assets/js/142.d4be7d06.js"><link rel="prefetch" href="/assets/js/143.6ede3cbe.js"><link rel="prefetch" href="/assets/js/144.65c0a1c0.js"><link rel="prefetch" href="/assets/js/145.2b9b7af2.js"><link rel="prefetch" href="/assets/js/146.d84d1354.js"><link rel="prefetch" href="/assets/js/147.5c31ced0.js"><link rel="prefetch" href="/assets/js/148.9929b86f.js"><link rel="prefetch" href="/assets/js/149.b1acb31c.js"><link rel="prefetch" href="/assets/js/15.73ad3ea7.js"><link rel="prefetch" href="/assets/js/150.8246e3f7.js"><link rel="prefetch" href="/assets/js/151.de2ec522.js"><link rel="prefetch" href="/assets/js/152.0b2c8d25.js"><link rel="prefetch" href="/assets/js/153.402a6101.js"><link rel="prefetch" href="/assets/js/154.bf5b21e2.js"><link rel="prefetch" href="/assets/js/155.f7018a76.js"><link rel="prefetch" href="/assets/js/156.52bc474f.js"><link rel="prefetch" href="/assets/js/157.09a8d951.js"><link rel="prefetch" href="/assets/js/158.a6bda80b.js"><link rel="prefetch" href="/assets/js/159.3aa05399.js"><link rel="prefetch" href="/assets/js/16.c277f496.js"><link rel="prefetch" href="/assets/js/160.09d218f3.js"><link rel="prefetch" href="/assets/js/161.fa98f9b8.js"><link rel="prefetch" href="/assets/js/162.5b32cc43.js"><link rel="prefetch" href="/assets/js/163.dfcc275d.js"><link rel="prefetch" href="/assets/js/164.981b75ed.js"><link rel="prefetch" href="/assets/js/165.a467b631.js"><link rel="prefetch" href="/assets/js/166.789991be.js"><link rel="prefetch" href="/assets/js/167.d69d48e1.js"><link rel="prefetch" href="/assets/js/168.2d3ec034.js"><link rel="prefetch" href="/assets/js/169.cefabf7d.js"><link rel="prefetch" href="/assets/js/17.38459ec9.js"><link rel="prefetch" href="/assets/js/170.e6b98c5d.js"><link rel="prefetch" href="/assets/js/171.43fcc790.js"><link rel="prefetch" href="/assets/js/172.e5fc9e58.js"><link rel="prefetch" href="/assets/js/173.a97ef26e.js"><link rel="prefetch" href="/assets/js/174.ee11026f.js"><link rel="prefetch" href="/assets/js/175.c3a5db14.js"><link rel="prefetch" href="/assets/js/176.4bbb5d9f.js"><link rel="prefetch" href="/assets/js/177.14851192.js"><link rel="prefetch" href="/assets/js/178.07ebf7d5.js"><link rel="prefetch" href="/assets/js/179.938ee81b.js"><link rel="prefetch" href="/assets/js/18.94d695a0.js"><link rel="prefetch" href="/assets/js/180.5b1c3f76.js"><link rel="prefetch" href="/assets/js/181.e0f3927c.js"><link rel="prefetch" href="/assets/js/182.e07fc186.js"><link rel="prefetch" href="/assets/js/183.f6ab4a94.js"><link rel="prefetch" href="/assets/js/184.b09ee1f6.js"><link rel="prefetch" href="/assets/js/185.2e636e79.js"><link rel="prefetch" href="/assets/js/186.3408c000.js"><link rel="prefetch" href="/assets/js/187.ab04b465.js"><link rel="prefetch" href="/assets/js/188.89ba47a3.js"><link rel="prefetch" href="/assets/js/189.d9ace9b8.js"><link rel="prefetch" href="/assets/js/19.ff281af4.js"><link rel="prefetch" href="/assets/js/190.cd51e1ae.js"><link rel="prefetch" href="/assets/js/191.1a195d93.js"><link rel="prefetch" href="/assets/js/192.c9b554db.js"><link rel="prefetch" href="/assets/js/193.9ae5e7f8.js"><link rel="prefetch" href="/assets/js/194.4b0ff7fc.js"><link rel="prefetch" href="/assets/js/195.0490fc4c.js"><link rel="prefetch" href="/assets/js/196.765f834b.js"><link rel="prefetch" href="/assets/js/197.54409b93.js"><link rel="prefetch" href="/assets/js/198.80d2610b.js"><link rel="prefetch" href="/assets/js/199.cccc9f86.js"><link rel="prefetch" href="/assets/js/20.89a504a6.js"><link rel="prefetch" href="/assets/js/200.5ab3eca6.js"><link rel="prefetch" href="/assets/js/201.ebf404c2.js"><link rel="prefetch" href="/assets/js/202.35cb40fc.js"><link rel="prefetch" href="/assets/js/203.8656bd46.js"><link rel="prefetch" href="/assets/js/204.b7f53355.js"><link rel="prefetch" href="/assets/js/205.ed04d8bc.js"><link rel="prefetch" href="/assets/js/206.6217e67e.js"><link rel="prefetch" href="/assets/js/207.60117759.js"><link rel="prefetch" href="/assets/js/208.3f7cfaae.js"><link rel="prefetch" href="/assets/js/209.9fc2f379.js"><link rel="prefetch" href="/assets/js/210.e0db30b2.js"><link rel="prefetch" href="/assets/js/211.786a55db.js"><link rel="prefetch" href="/assets/js/212.e47d35d1.js"><link rel="prefetch" href="/assets/js/213.bc93c223.js"><link rel="prefetch" href="/assets/js/214.ab8ecb5b.js"><link rel="prefetch" href="/assets/js/215.8cf4c215.js"><link rel="prefetch" href="/assets/js/216.30f241da.js"><link rel="prefetch" href="/assets/js/217.0024d9ce.js"><link rel="prefetch" href="/assets/js/218.6ce2301c.js"><link rel="prefetch" href="/assets/js/219.438fb915.js"><link rel="prefetch" href="/assets/js/22.c37cc9fa.js"><link rel="prefetch" href="/assets/js/220.0886089d.js"><link rel="prefetch" href="/assets/js/221.57c60d24.js"><link rel="prefetch" href="/assets/js/222.be4e9028.js"><link rel="prefetch" href="/assets/js/223.98c5dcef.js"><link rel="prefetch" href="/assets/js/224.9c5935e1.js"><link rel="prefetch" href="/assets/js/225.4eda7826.js"><link rel="prefetch" href="/assets/js/226.b93cb259.js"><link rel="prefetch" href="/assets/js/227.29050d75.js"><link rel="prefetch" href="/assets/js/228.1e25561d.js"><link rel="prefetch" href="/assets/js/229.7ca5e0ab.js"><link rel="prefetch" href="/assets/js/23.526b5924.js"><link rel="prefetch" href="/assets/js/230.02332374.js"><link rel="prefetch" href="/assets/js/231.1552d244.js"><link rel="prefetch" href="/assets/js/232.cda13b24.js"><link rel="prefetch" href="/assets/js/233.297c5d8f.js"><link rel="prefetch" href="/assets/js/234.49da1229.js"><link rel="prefetch" href="/assets/js/235.0e92aad6.js"><link rel="prefetch" href="/assets/js/236.a7733e12.js"><link rel="prefetch" href="/assets/js/237.31fac7f1.js"><link rel="prefetch" href="/assets/js/238.6d2d80d6.js"><link rel="prefetch" href="/assets/js/239.d668b21d.js"><link rel="prefetch" href="/assets/js/24.4f58e38d.js"><link rel="prefetch" href="/assets/js/240.9e4fb5f8.js"><link rel="prefetch" href="/assets/js/25.2e1c4694.js"><link rel="prefetch" href="/assets/js/26.9dd20d3a.js"><link rel="prefetch" href="/assets/js/27.635bd2a5.js"><link rel="prefetch" href="/assets/js/28.0e543018.js"><link rel="prefetch" href="/assets/js/29.ae9ddba5.js"><link rel="prefetch" href="/assets/js/3.86caf6b0.js"><link rel="prefetch" href="/assets/js/30.a9cd6ec3.js"><link rel="prefetch" href="/assets/js/31.f1c832ac.js"><link rel="prefetch" href="/assets/js/32.824382ae.js"><link rel="prefetch" href="/assets/js/33.f8aa450d.js"><link rel="prefetch" href="/assets/js/34.40eb032e.js"><link rel="prefetch" href="/assets/js/35.068ab380.js"><link rel="prefetch" href="/assets/js/36.1a2181dd.js"><link rel="prefetch" href="/assets/js/37.5a8e1320.js"><link rel="prefetch" href="/assets/js/38.eb7e9faa.js"><link rel="prefetch" href="/assets/js/39.3ef8e6e4.js"><link rel="prefetch" href="/assets/js/4.2601b2b8.js"><link rel="prefetch" href="/assets/js/40.a04162a3.js"><link rel="prefetch" href="/assets/js/41.2b363e5f.js"><link rel="prefetch" href="/assets/js/42.d3ada882.js"><link rel="prefetch" href="/assets/js/43.2c59e3d5.js"><link rel="prefetch" href="/assets/js/44.2dccdc1c.js"><link rel="prefetch" href="/assets/js/45.21384323.js"><link rel="prefetch" href="/assets/js/46.f8cfeddb.js"><link rel="prefetch" href="/assets/js/47.1931eb78.js"><link rel="prefetch" href="/assets/js/48.af372779.js"><link rel="prefetch" href="/assets/js/49.ff2e443c.js"><link rel="prefetch" href="/assets/js/5.db71aeed.js"><link rel="prefetch" href="/assets/js/50.1d0073cb.js"><link rel="prefetch" href="/assets/js/51.2947e174.js"><link rel="prefetch" href="/assets/js/52.aae698b5.js"><link rel="prefetch" href="/assets/js/53.961c4157.js"><link rel="prefetch" href="/assets/js/54.c5979d45.js"><link rel="prefetch" href="/assets/js/55.3c1fbcca.js"><link rel="prefetch" href="/assets/js/56.498de876.js"><link rel="prefetch" href="/assets/js/57.8c1c1a48.js"><link rel="prefetch" href="/assets/js/58.39c23a96.js"><link rel="prefetch" href="/assets/js/59.93c11385.js"><link rel="prefetch" href="/assets/js/6.9dafb709.js"><link rel="prefetch" href="/assets/js/60.3ecdf03a.js"><link rel="prefetch" href="/assets/js/61.e7cd083d.js"><link rel="prefetch" href="/assets/js/62.abce1f90.js"><link rel="prefetch" href="/assets/js/63.4e194800.js"><link rel="prefetch" href="/assets/js/64.f166db1a.js"><link rel="prefetch" href="/assets/js/65.982109c1.js"><link rel="prefetch" href="/assets/js/66.ac2f358b.js"><link rel="prefetch" href="/assets/js/67.b67d6b07.js"><link rel="prefetch" href="/assets/js/68.d829d2b0.js"><link rel="prefetch" href="/assets/js/69.45b49843.js"><link rel="prefetch" href="/assets/js/7.a0276b27.js"><link rel="prefetch" href="/assets/js/70.bd774ae6.js"><link rel="prefetch" href="/assets/js/71.3cde9828.js"><link rel="prefetch" href="/assets/js/72.107bf470.js"><link rel="prefetch" href="/assets/js/73.7007a5ce.js"><link rel="prefetch" href="/assets/js/74.6e08bbcf.js"><link rel="prefetch" href="/assets/js/75.85f8da42.js"><link rel="prefetch" href="/assets/js/76.dfc3e8df.js"><link rel="prefetch" href="/assets/js/77.dfc7b715.js"><link rel="prefetch" href="/assets/js/78.c3949c54.js"><link rel="prefetch" href="/assets/js/79.005ff1d3.js"><link rel="prefetch" href="/assets/js/8.26d59edf.js"><link rel="prefetch" href="/assets/js/80.ec5caca7.js"><link rel="prefetch" href="/assets/js/81.ead29b4b.js"><link rel="prefetch" href="/assets/js/82.5b38b340.js"><link rel="prefetch" href="/assets/js/83.82d06e5e.js"><link rel="prefetch" href="/assets/js/84.e1fb9c56.js"><link rel="prefetch" href="/assets/js/85.5a0444f5.js"><link rel="prefetch" href="/assets/js/86.edb78780.js"><link rel="prefetch" href="/assets/js/87.3e1eb65b.js"><link rel="prefetch" href="/assets/js/88.d1bbb465.js"><link rel="prefetch" href="/assets/js/89.dec7a427.js"><link rel="prefetch" href="/assets/js/9.404400bd.js"><link rel="prefetch" href="/assets/js/90.0cebc9de.js"><link rel="prefetch" href="/assets/js/91.50d7a5f4.js"><link rel="prefetch" href="/assets/js/92.7b58335d.js"><link rel="prefetch" href="/assets/js/93.e3c416f6.js"><link rel="prefetch" href="/assets/js/94.1bb74f5e.js"><link rel="prefetch" href="/assets/js/95.34cb0a21.js"><link rel="prefetch" href="/assets/js/96.2e54bee1.js"><link rel="prefetch" href="/assets/js/97.4b5fab2d.js"><link rel="prefetch" href="/assets/js/98.a83c1edb.js"><link rel="prefetch" href="/assets/js/99.8a2757cd.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.c4426655.js">
    <link rel="stylesheet" href="/assets/css/0.styles.76f153c4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="前端知识" class="logo"> <span class="site-name can-hide">前端知识</span></a> <div class="links" style="max-width:nullpx;"><form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/catalog.html" class="nav-link">目录</a></div><div class="nav-item"><a href="/doc/es6/" class="nav-link">ES6</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">javascript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc/js/" class="nav-link router-link-active">js</a></li><li class="dropdown-item"><!----> <a href="/doc/js/standardLibrary/" class="nav-link">js标准库</a></li><li class="dropdown-item"><!----> <a href="/doc/dom/" class="nav-link">dom操作文档</a></li><li class="dropdown-item"><!----> <a href="/doc/designPattern/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><a href="/doc/browserNetwork/" class="nav-link">浏览器</a></div><div class="nav-item"><a href="/doc/css/" class="nav-link">CSS</a></div><div class="nav-item"><a href="/doc/react/" class="nav-link">react</a></div><div class="nav-item"><a href="/doc/vue/" class="nav-link">vue</a></div><div class="nav-item"><a href="/doc/typeScript/" class="nav-link">TypeScript</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc/html/" class="nav-link">html</a></li><li class="dropdown-item"><!----> <a href="/doc/node/" class="nav-link">node</a></li><li class="dropdown-item"><!----> <a href="/doc/tool/" class="nav-link">工具</a></li><li class="dropdown-item"><!----> <a href="/doc/tool/echarts/" class="nav-link">echarts</a></li><li class="dropdown-item"><!----> <a href="/doc/problem/" class="nav-link">常见问题</a></li></ul></div></div> <a href="https://github.com/yulilong/front-end-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/catalog.html" class="nav-link">目录</a></div><div class="nav-item"><a href="/doc/es6/" class="nav-link">ES6</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">javascript</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc/js/" class="nav-link router-link-active">js</a></li><li class="dropdown-item"><!----> <a href="/doc/js/standardLibrary/" class="nav-link">js标准库</a></li><li class="dropdown-item"><!----> <a href="/doc/dom/" class="nav-link">dom操作文档</a></li><li class="dropdown-item"><!----> <a href="/doc/designPattern/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><a href="/doc/browserNetwork/" class="nav-link">浏览器</a></div><div class="nav-item"><a href="/doc/css/" class="nav-link">CSS</a></div><div class="nav-item"><a href="/doc/react/" class="nav-link">react</a></div><div class="nav-item"><a href="/doc/vue/" class="nav-link">vue</a></div><div class="nav-item"><a href="/doc/typeScript/" class="nav-link">TypeScript</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc/html/" class="nav-link">html</a></li><li class="dropdown-item"><!----> <a href="/doc/node/" class="nav-link">node</a></li><li class="dropdown-item"><!----> <a href="/doc/tool/" class="nav-link">工具</a></li><li class="dropdown-item"><!----> <a href="/doc/tool/echarts/" class="nav-link">echarts</a></li><li class="dropdown-item"><!----> <a href="/doc/problem/" class="nav-link">常见问题</a></li></ul></div></div> <a href="https://github.com/yulilong/front-end-doc" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/doc/js/" class="sidebar-link">JavaScript部分说明</a></li><li><a href="/doc/js/001-对象原型继承.html" class="sidebar-link">对象原型继承</a></li><li><a href="/doc/js/002-this_call_apply_bind.html" class="sidebar-link">this、call、apply、bind</a></li><li><a href="/doc/js/003-数据类型转换.html" class="sidebar-link">数据类型转换</a></li><li><a href="/doc/js/004-跨域.html" class="sidebar-link">跨域</a></li><li><a href="/doc/js/005-Ajax.html" class="sidebar-link">Ajax</a></li><li><a href="/doc/js/007-作用域-执行环境.html" class="sidebar-link">作用域</a></li><li><a href="/doc/js/008-排序算法.html" class="sidebar-link">排序算法</a></li><li><a href="/doc/js/009-获取标签宽高及实例.html" class="sidebar-link">获取标签的宽高及例子</a></li><li><a href="/doc/js/013-JS数字计算精度和显示.html" class="one-level one-level-active active sidebar-link">Number运算精度和大数显示问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc/js/013-JS数字计算精度和显示.html#_1-开发遇到的计算问题" class="sidebar-link">1. 开发遇到的计算问题</a></li><li class="sidebar-sub-header"><a href="/doc/js/013-JS数字计算精度和显示.html#_2-number存储方式和计算" class="sidebar-link">2. Number存储方式和计算</a></li><li class="sidebar-sub-header"><a href="/doc/js/013-JS数字计算精度和显示.html#_3-第三方类库解决" class="sidebar-link">3. 第三方类库解决</a></li><li class="sidebar-sub-header"><a href="/doc/js/013-JS数字计算精度和显示.html#_4-自定义函数解决" class="sidebar-link">4. 自定义函数解决</a></li><li class="sidebar-sub-header"><a href="/doc/js/013-JS数字计算精度和显示.html#_5-tofixed-保留小数精度丢失问题解决" class="sidebar-link">5. toFixed()保留小数精度丢失问题解决</a></li><li class="sidebar-sub-header"><a href="/doc/js/013-JS数字计算精度和显示.html#_6-超大-小-数显示问题：解决数字显示中的-e-和-e" class="sidebar-link">6. 超大(小)数显示问题：解决数字显示中的'e'和'E'</a></li><li class="sidebar-sub-header"><a href="/doc/js/013-JS数字计算精度和显示.html#参考资料" class="sidebar-link">参考资料</a></li></ul></li><li><a href="/doc/js/014-Web-Worker使用教程.html" class="sidebar-link">Web Worker 使用教程</a></li><li><a href="/doc/js/015-JS常见问题解决.html" class="sidebar-link">JS常见问题解决</a></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>JS效果-代码片段</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/doc/js/01-js-example/01-常用的代码片段.html" class="sidebar-link">常用代码片段</a></li><li><a href="/doc/js/01-js-example/02-示例1.html" class="sidebar-link">代码示例1</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>函数</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/doc/js/006-函数.html" class="sidebar-link">函数</a></li><li><a href="/doc/js/006-1函数柯里化.html" class="sidebar-link">函数柯里化</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>JS代码执行机制和事件循环</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>高级</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>文章</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/doc/js/blog/001-JS常用的60余种工具方法.html" class="sidebar-link">JS常用的60余种工具方法</a></li><li><a href="/doc/js/blog/002-js数据类型判断.html" class="sidebar-link">JS数据类型判断</a></li><li><a href="/doc/js/blog/003-js开启摄像头照相人脸识别.html" class="sidebar-link">页面开启摄像头照相</a></li><li><a href="/doc/js/blog/004-浏览器控制台反调试.html" class="sidebar-link">浏览器控制台反调试</a></li><li><a href="/doc/js/blog/006-JS调用iframe中页面dom.html" class="sidebar-link">前端JS调用iframe中页面事件实现</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><p></p><div class="table-of-contents"><ul><li><a href="#_1-开发遇到的计算问题">1. 开发遇到的计算问题</a></li><li><a href="#_2-number存储方式和计算">2. Number存储方式和计算</a><ul><li><a href="#_2-1-一个存储例子">2.1 一个存储例子</a></li><li><a href="#_2-2-小数计算过程">2.2 小数计算过程</a></li></ul></li><li><a href="#_3-第三方类库解决">3. 第三方类库解决</a></li><li><a href="#_4-自定义函数解决">4. 自定义函数解决</a><ul><li><a href="#_4-1-加法函数">4.1 加法函数</a></li><li><a href="#_4-2-减法函数">4.2 减法函数</a></li><li><a href="#_4-3-乘法函数">4.3 乘法函数</a></li><li><a href="#_4-4-除法函数">4.4 除法函数</a></li><li><a href="#_4-5-格式化数字、金额、保留几位小数等">4.5 格式化数字、金额、保留几位小数等</a></li></ul></li><li><a href="#_5-tofixed-保留小数精度丢失问题解决">5. toFixed()保留小数精度丢失问题解决</a></li><li><a href="#_6-超大-小-数显示问题：解决数字显示中的-e-和-e">6. 超大(小)数显示问题：解决数字显示中的'e'和'E'</a></li><li><a href="#参考资料">参考资料</a></li></ul></div><p></p> <p>[TOC]</p> <h1 id="number运算精度和大数显示问题"><a href="#number运算精度和大数显示问题" aria-hidden="true" class="header-anchor">#</a> Number运算精度和大数显示问题</h1> <h2 id="_1-开发遇到的计算问题"><a href="#_1-开发遇到的计算问题" aria-hidden="true" class="header-anchor">#</a> 1. 开发遇到的计算问题</h2> <p>在项目开发过程中遇到了一个计算数学问题：</p> <p><code>89*0.15 + 85*0.1 + 84*0.1 + 86*0.2 + 92*0.25 + 97*0.2 = 89.85000000000001</code></p> <p><img src="/assets/img/028-float.f605ac6f.png" alt></p> <p>在 JavaScript 中整数和和小数都属于 <code>Number</code> 数据类型，都是是采用 <a href="https://zh.wikipedia.org/wiki/IEEE_754" target="_blank" rel="noopener noreferrer">IEEE 754 标准<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的 64 位双精度浮点数。 当浮点数做数学运算的时候，你经常会发现一些问题：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 加法</span>
<span class="token comment">// 0.1 + 0.2 = 0.30000000000000004</span>
<span class="token comment">// 0.7 + 0.1 = 0.7999999999999999</span>
<span class="token comment">// 0.2 + 0.4 = 0.6000000000000001</span>
<span class="token comment">// 89*0.15 + 85*0.1 + 84*0.1 + 86*0.2 + 92*0.25 + 97*0.2 = 89.85000000000001</span>
 
<span class="token comment">// 减法</span>
<span class="token comment">// 1.5 - 1.2 = 0.30000000000000004</span>
<span class="token comment">// 0.3 - 0.2 = 0.09999999999999998</span>
 
<span class="token comment">// 乘法</span>
<span class="token comment">// 19.9 * 100 = 1989.9999999999998</span>
<span class="token comment">// 19.9 * 10 * 10 = 1990</span>
<span class="token comment">// 1306377.64 * 100 = 130637763.99999999</span>
<span class="token comment">// 1306377.64 * 10 * 10 = 130637763.99999999</span>
<span class="token comment">// 0.7 * 180 = 125.99999999999999</span>

<span class="token comment">// 除法</span>
<span class="token comment">// 0.3 / 0.1 = 2.9999999999999996</span>
<span class="token comment">// 0.69 / 10 = 0.06899999999999999</span>
</code></pre></div><p>在JS中，整数精度同样存在问题：</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">19571992547450991</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// 19571992547450990</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">19571992547450991</span><span class="token operator">===</span><span class="token number">19571992547450992</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>                                <span class="token comment">// 9007199254740991</span>
Number<span class="token punctuation">.</span><span class="token constant">MAX_SAFE_INTEGER</span>                            <span class="token comment">// 9007199254740991</span>
Number<span class="token punctuation">.</span><span class="token constant">MIN_SAFE_INTEGER</span>                            <span class="token comment">// -9007199254740991</span>
</code></pre></div><p>在 JavaScript 中 <code>Number</code>类型统一按浮点数处理，整数是按最大54位来算最大(<code>2^53 - 1</code>，<code>Number.MAX_SAFE_INTEGER</code>,<code>9007199254740991</code>) 和最小(<code>-(2^53 - 1)</code>，<code>Number.MIN_SAFE_INTEGER</code>,<code>-9007199254740991</code>) 安全整数范围的。所以只要超过这个范围，就会存在被舍去的精度问题。</p> <p>这个问题并不只是在 JS 中才会出现，几乎所有的编程语言都采用了 IEEE-745 浮点数表示法，任何使用二进制浮点数的编程语言都会有这个问题，只不过在很多其他语言中已经封装好了方法来避免精度的问题，而 JS 是一门弱类型的语言，从设计思想上就没有对浮点数有个严格的数据类型，所以精度误差的问题就显得格外突出。</p> <h2 id="_2-number存储方式和计算"><a href="#_2-number存储方式和计算" aria-hidden="true" class="header-anchor">#</a> 2. Number存储方式和计算</h2> <p>根据IEEE 754标准，任意一个<strong>二进制浮点数</strong> V 可以表示成下面的形式：</p> <blockquote><p><img src="data:image/png;base64,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" alt></p> <p><strong>（1）(-1)^s表示符号位，s=0，V为正数；s=1，V为负数。</strong><br> <strong>（2）M表示有效数字，大于等于1，小于2。</strong><br> <strong>（3）2^E表示指数位。</strong><br> <strong>例如：二进制<code>1111</code>换算成指数表示法就是<code>(-1)^0 * 1.111 * 2^3</code></strong></p></blockquote> <p>对于64位的浮点数在内存中的表示，最高的1位是符号位，接着的11位是指数，剩下的52位为有效数字，具体：</p> <ul><li>第0位到第51位：储存小数部分（即有效数字M），决定了数值的精度；</li> <li>第52位到第62位：储存指数部分(E)，决定了数值的大小；</li> <li>第63位：符号位(S)，0表示正数，1表示负数；</li></ul> <p><img src="/assets/img/024-float.3475d803.jpg" alt></p> <ul><li><p>对有效数字M的规定：</p> <p>1≤M&lt;2，也就是说，M是1.xxxxxx的形式，其中xxxxxx表示小数部分。<strong>IEEE 754规定，在计算机内部保存M时，默认这个数的第一位总是1，因此可以被舍去，只保存后面的xxxxxx部分</strong>。比如保存1.01的时候，只保存01，等到读取的时候，再把第一位的1加上去。这样做的目的，是节省1位有效数字。因此最大有效位数是53位。</p></li> <li><p>关于指数E：</p> <p>E为一个无符号整数，由于长度是11位，它的取值范围为0~2047。但是，科学计数法中的E是可以出现负数的，<strong>所以标准规定，E的真实值必须再减去一个中间数，对于11位的E，这个中间数是1023</strong>。然后，指数E还可以再分成三种情况：</p> <ul><li>1、<strong>E不全为0或不全为1</strong>。这时就采用上面的规则表示，即指数E的计算值减去1023，得到真实值，再将有效数字M前加上第一位的1。</li> <li>2、<strong>E全为0</strong>。这时，实际指数E等于-1023，有效数字M不再加上第一位的1，而是还原为0.xxxxxx的小数。这样做是为了表示±0，以及接近于0的很小的数字。</li> <li>3、<strong>E全为1</strong>。这时，如果有效数字M全为0，表示±无穷大（正负取决于符号位s）；如果有效数字M不全为0，表示这个数不是一个数（NaN）。</li></ul> <p><img src="/assets/img/030-float.ab1a4a2b.png" alt></p></li></ul> <h3 id="_2-1-一个存储例子"><a href="#_2-1-一个存储例子" aria-hidden="true" class="header-anchor">#</a> 2.1 一个存储例子</h3> <p>比如数字15，转换为二进制：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 1111</span>
</code></pre></div><p>二进制<code>1111</code>换算成指数表示法就是<code>(-1)^0 * 1.111 * 2^3</code>:</p> <ul><li>符号位S：0</li> <li>指数位E：01111111110(1023)  + 11(3) = 10000000010(1026)</li> <li>小数位M：111</li></ul> <p><img src="/assets/img/027-float.ff7b5cc2.png" alt></p> <h3 id="_2-2-小数计算过程"><a href="#_2-2-小数计算过程" aria-hidden="true" class="header-anchor">#</a> 2.2 小数计算过程</h3> <p>以<code>0.1 + 0.2</code>为例：</p> <p>1、首先十进制要转化为二进制(第一次损失精度)：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 0.1、0.2 的二进制：无线循环，截取到53位</span>
<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// '0.000110011 0011 0011 001100110011001100110011001100110011' </span>
<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// '0.001100110 0110 0110 011001100110011001100110011001100110'</span>
</code></pre></div><p>2、IEEE 754浮点数的小数部分最多支持 53 位二进制位，所以两者相加之后得到二进制为(第二次损失精度)：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">0.01001100110011001100110011001100110011001100110011001</span> 
</code></pre></div><p>3、因浮点数小数位的限制而截断的二进制数字，再转换为十进制，就成了 <code>0.30000000000000004</code>。所以在进行算术计算时会产生误差。</p> <p>二进制和十进制互相转换方法：</p> <p><img src="/assets/img/029-float.b9b57da0.png" alt></p> <h2 id="_3-第三方类库解决"><a href="#_3-第三方类库解决" aria-hidden="true" class="header-anchor">#</a> 3. 第三方类库解决</h2> <p>通常这种对精度要求高的计算都应该交给后端去计算和存储，因为后端有成熟的库来解决这种计算问题。前端也有几个类似的库(大量计算会影响页面性能)：</p> <ul><li><p><a href="http://mathjs.org/" target="_blank" rel="noopener noreferrer">Math.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <p>Math.js 是专门为 JavaScript 和 Node.js 提供的一个广泛的数学库。它具有灵活的表达式解析器，支持符号计算，配有大量内置函数和常量，并提供集成解决方案来处理不同的数据类型像数字，大数字(超出安全数的数字)，复数，分数，单位和矩阵。 功能强大，易于使用。GitHub：https://github.com/josdejong/mathjs</p></li> <li><p><a href="http://mikemcl.github.io/decimal.js/" target="_blank" rel="noopener noreferrer">decimal.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <p>为 JavaScript 提供十进制类型的任意精度数值。GitHub：https://github.com/MikeMcl/decimal.js</p></li> <li><p><a href="http://mikemcl.github.io/big.js" target="_blank" rel="noopener noreferrer">big.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <p>一个小、快速，易于使用的十进制类型任意精度计算的库。GitHub：https://github.com/MikeMcl/big.js/</p></li> <li><p><a href="http://numeraljs.com/" target="_blank" rel="noopener noreferrer">Numeral.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <p>一个用于格式化和操作数字的JavaScript库。数字可以被格式化为货币，百分比，时间，几个小数位数，千分位等等。GitHub：https://github.com/adamwdraper/Numeral-js</p></li> <li><p><a href="http://openexchangerates.github.io/accounting.js/" target="_blank" rel="noopener noreferrer">accounting.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <p>一个很小的JavaScript库，提供简单和高级的数字、货币和货币格式。它是轻量级的，没有依赖关系，适用于所有客户端和服务器端JavaScript应用程序。GitHub：https://github.com/openexchangerates/accounting.js</p></li></ul> <p>这几个类库帮我们解决很多这类问题，不过前端大部分都是做展示数据，大量计算数据的情况很少，所以很多时候，一个函数能解决的问题，就不需要引用类库了。</p> <h2 id="_4-自定义函数解决"><a href="#_4-自定义函数解决" aria-hidden="true" class="header-anchor">#</a> 4. 自定义函数解决</h2> <h3 id="_4-1-加法函数"><a href="#_4-1-加法函数" aria-hidden="true" class="header-anchor">#</a> 4.1 加法函数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 加法函数，用来得到精确的加法结果
 * 说明：JS的加法结果会有误差，在两个浮点数相加的时候会比较明显。这个函数返回较为精确的加法结果。
 * 调用：accAdd(arg1,arg2)
 * 返回值：arg1加上arg2的精确结果
 * 原理： 小数变成整数，相加后在变回小数， 如： 1.12 + 0.123 =&gt; (1.12 * 1000 + 0.123 * 1000) / 1000
 */</span>
<span class="token keyword">function</span> <span class="token function">accAdd</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取参数1的小数长度，比如 12.12345，那么 r1 === 5</span>
    r1 <span class="token operator">=</span> arg1<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/**/</span> <span class="token punctuation">}</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取参数2的小数长度，比如 12.12345，那么 r2 === 5</span>
    r2 <span class="token operator">=</span> arg2<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/**/</span> <span class="token punctuation">}</span>
  <span class="token keyword">const</span> m <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>r1<span class="token punctuation">,</span> r2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 小数位数最多的，10的次幂</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>arg1 <span class="token operator">*</span> m  <span class="token operator">+</span> arg2 <span class="token operator">*</span> m<span class="token punctuation">)</span> <span class="token operator">/</span> m<span class="token punctuation">;</span> <span class="token comment">// // 整数相加后，变回小数</span>
<span class="token punctuation">}</span>

<span class="token comment">// 给Number类型增加一个add方法，调用起来更加方便。</span>
Number<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">accAdd</span><span class="token punctuation">(</span>arg<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'0.1 + 0.2 = '</span><span class="token punctuation">,</span> <span class="token function">accAdd</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'0.7 + 0.1 = '</span><span class="token punctuation">,</span> <span class="token function">accAdd</span><span class="token punctuation">(</span><span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-2-减法函数"><a href="#_4-2-减法函数" aria-hidden="true" class="header-anchor">#</a> 4.2 减法函数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 减法函数，用来得到精确的减法结果
 * 说明：javascript的减法结果会有误差，在两个浮点数相减的时候会比较明显。这个函数返回较为精确的减法结果。
 * 调用：accSub(arg1,arg2)
 * 返回值：arg1加上arg2的精确结果
 * 原理： 小数变成整数，相减后在变回小数， 如： 1.12 - 0.123 =&gt; (1.12 * 1000 - 0.123 * 1000) / 1000
 */</span>
<span class="token keyword">function</span> <span class="token function">accSub</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
      r1 <span class="token operator">=</span> arg1<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/**/</span> <span class="token punctuation">}</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
      r2 <span class="token operator">=</span> arg2<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/**/</span> <span class="token punctuation">}</span>
  <span class="token keyword">const</span> n <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>r1<span class="token punctuation">,</span> r2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> m <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 小数位数最多的，10的次幂</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>arg1 <span class="token operator">*</span> m <span class="token operator">-</span> arg2 <span class="token operator">*</span> m<span class="token punctuation">)</span> <span class="token operator">/</span> m<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 给Number类型增加一个sub方法，调用起来更加方便。</span>
Number<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sub</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">accSub</span><span class="token punctuation">(</span>arg<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1.5 - 1.2 = '</span><span class="token punctuation">,</span> <span class="token function">accSub</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">1.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'0.3 - 0.2 = '</span><span class="token punctuation">,</span> <span class="token function">accSub</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-3-乘法函数"><a href="#_4-3-乘法函数" aria-hidden="true" class="header-anchor">#</a> 4.3 乘法函数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 乘法函数，用来得到精确的乘法结果
 * 说明：JS的乘法结果会有误差，在两个浮点数相乘的时候会比较明显。这个函数返回较为精确的乘法结果。
 * 调用：accMul(arg1,arg2)
 * 返回值：arg1乘以 arg2的精确结果
 */</span>
<span class="token keyword">function</span> <span class="token function">accMul</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
  <span class="token keyword">const</span> s1 <span class="token operator">=</span> arg1<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> s2 <span class="token operator">=</span> arg2<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
      m <span class="token operator">+=</span> s1<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/**/</span> <span class="token punctuation">}</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
      m <span class="token operator">+=</span> s2<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/**/</span> <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">Number</span><span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">Number</span><span class="token punctuation">(</span>s2<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 给Number类型增加一个mul方法，调用起来更加方便。</span>
Number<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">mul</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">accMul</span><span class="token punctuation">(</span>arg<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'0.5 * 0.008'</span><span class="token punctuation">,</span> <span class="token function">accMul</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.008</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'19.9 * 100'</span><span class="token punctuation">,</span> <span class="token function">accMul</span><span class="token punctuation">(</span><span class="token number">19.9</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'0.7 * 180'</span><span class="token punctuation">,</span> <span class="token function">accMul</span><span class="token punctuation">(</span><span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'500 * 300'</span><span class="token punctuation">,</span> <span class="token function">accMul</span><span class="token punctuation">(</span><span class="token string">'500'</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-4-除法函数"><a href="#_4-4-除法函数" aria-hidden="true" class="header-anchor">#</a> 4.4 除法函数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/** 
 * 除法函数，用来得到精确的除法结果
 * 说明：JS的除法结果会有误差，在两个浮点数相除的时候会比较明显。这个函数返回较为精确的除法结果。
 * 调用：accDiv(arg1,arg2)
 * 返回值：arg1除以arg2的精确结果
 */</span>
<span class="token keyword">function</span> <span class="token function">accDiv</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> t1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> t2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
      t1 <span class="token operator">=</span> arg1<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/**/</span> <span class="token punctuation">}</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
      t2 <span class="token operator">=</span> arg2<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/**/</span> <span class="token punctuation">}</span>
  <span class="token keyword">const</span> r1 <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>arg1<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> r2 <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>arg2<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>r1 <span class="token operator">/</span> r2<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> t2 <span class="token operator">-</span> t1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 给Number类型增加一个div方法，调用起来更加方便。</span>
Number<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">div</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">accDiv</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'0.3 / 0.1 = '</span><span class="token punctuation">,</span> <span class="token function">accDiv</span><span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'0.69 / 10 = '</span><span class="token punctuation">,</span> <span class="token function">accDiv</span><span class="token punctuation">(</span><span class="token number">0.69</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'10 / 1 = '</span><span class="token punctuation">,</span> <span class="token function">accDiv</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-5-格式化数字、金额、保留几位小数等"><a href="#_4-5-格式化数字、金额、保留几位小数等" aria-hidden="true" class="header-anchor">#</a> 4.5 格式化数字、金额、保留几位小数等</h3> <p>一般格式化金额需要千分位分隔，保留2位小数等等。</p> <p>如果只是显示，不需要处理，则可以用JS自带的toLocaleString方法直接处理(会自动保留3位小数)：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token number">614321321.55555</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// '614,321,321.556'</span>
</code></pre></div><p>在处理金融保险的业务场景的时候，由于关系到经济利益，在格式化、保留几位小数的时候，还要考虑舍去或者舍入几厘。每个用户几厘钱可能带来巨大的经济收益。就比如说收手续费，如果一笔手续费计算出来是 <code>3.4521</code> 元，精确到分一般都会收 <code>3.46</code> 元。当然如果是付出去，那可能就是直接舍去了，一般会计算为 <code>3.45</code> 元。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
 * 格式化数字、金额、保留几位小数
 * number：要格式化的数字
 * decimals：保留几位小数
 * decPoint：小数点符号
 * thousandsSep：千分位符号,默认 &quot;,&quot;
 * roundTag:舍入参数，默认 &quot;ceil&quot; 向上取,&quot;floor&quot;向下取,&quot;round&quot; 四舍五入
 */</span>
<span class="token keyword">function</span> <span class="token function">numberFormat</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> decimals<span class="token punctuation">,</span> decPoint<span class="token punctuation">,</span> thousandsSep<span class="token punctuation">,</span> roundTag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  number <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>number<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/[^0-9eE.+-]/g</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 删除 跟数字无关的字符</span>
  roundTag <span class="token operator">=</span> roundTag <span class="token operator">||</span> <span class="token string">&quot;ceil&quot;</span><span class="token punctuation">;</span> <span class="token comment">// &quot;ceil&quot;,&quot;floor&quot;,&quot;round&quot;</span>
  <span class="token keyword">const</span> n <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">isFinite</span><span class="token punctuation">(</span><span class="token operator">+</span>number<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token punctuation">:</span> <span class="token operator">+</span>number<span class="token punctuation">;</span> <span class="token comment">// 是数字</span>
  <span class="token keyword">const</span> prec <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">isFinite</span><span class="token punctuation">(</span><span class="token operator">+</span>decimals<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>decimals<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> sep <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> thousandsSep <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">','</span> <span class="token punctuation">:</span> thousandsSep<span class="token punctuation">;</span>
  <span class="token keyword">const</span> dec <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> decPoint <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'.'</span> <span class="token punctuation">:</span> decPoint<span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">toFixedFix</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span> prec<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> k <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> prec<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">parseFloat</span><span class="token punctuation">(</span>Math<span class="token punctuation">[</span>roundTag<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n <span class="token operator">*</span> k<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span>prec<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span>prec<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> k<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> s <span class="token operator">=</span> <span class="token punctuation">(</span>prec <span class="token operator">?</span> <span class="token function">toFixedFix</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> prec<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 整数、小数 分开</span>
  <span class="token keyword">const</span> re <span class="token operator">=</span> <span class="token regex">/(-?\d+)(\d{3})/</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>re<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>re<span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`$1</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>sep<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">$2`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&lt;</span> prec<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">;</span>
    s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>prec <span class="token operator">-</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> s<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>dec<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">numberFormat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// &quot;2.00&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">numberFormat</span><span class="token punctuation">(</span><span class="token number">3.7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// &quot;3.70&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">numberFormat</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// &quot;3&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">numberFormat</span><span class="token punctuation">(</span><span class="token number">9.0312</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// &quot;9.04&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">numberFormat</span><span class="token punctuation">(</span><span class="token number">9.00</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// &quot;9.00&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">numberFormat</span><span class="token punctuation">(</span><span class="token number">39.715001</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;floor&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// &quot;39.71&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">numberFormat</span><span class="token punctuation">(</span><span class="token number">9.7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// &quot;9.70&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">numberFormat</span><span class="token punctuation">(</span><span class="token number">39.7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// &quot;39.70&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">numberFormat</span><span class="token punctuation">(</span><span class="token number">9.70001</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// &quot;9.71&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">numberFormat</span><span class="token punctuation">(</span><span class="token number">39.70001</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// &quot;39.71&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">numberFormat</span><span class="token punctuation">(</span><span class="token number">9996.03</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// &quot;9,996.03&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">numberFormat</span><span class="token punctuation">(</span><span class="token number">1.797</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;.&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;floor&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">// &quot;1.79&quot;</span>
</code></pre></div><p>参考：https://www.html.cn/archives/7324，对参考的方法进行了优化和改进</p> <h2 id="_5-tofixed-保留小数精度丢失问题解决"><a href="#_5-tofixed-保留小数精度丢失问题解决" aria-hidden="true" class="header-anchor">#</a> 5. toFixed()保留小数精度丢失问题解决</h2> <p>当对数字处理保留几位小数的，会经常用到<code>toFixed()</code>方法，此方法会对数据进行四舍五入的方式截取小数，但是此方法会对小数5处理不准：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token number">1.345</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment">// 1.34    错误</span>
<span class="token punctuation">(</span><span class="token number">1.375</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment">// 1.38    正确</span>
<span class="token punctuation">(</span><span class="token number">10.055</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 10.05   错误</span>
<span class="token punctuation">(</span><span class="token number">10.005</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 10.01   正确</span>
</code></pre></div><p>对于不需要精确的地方没什么问题，但是遇到如下场景就不行了：</p> <ul><li>1、对项目打分、涉及排名等</li> <li>2、金融保险等涉及金额，关系到经济利益的时候</li></ul> <p>因此需要精确处理小数位数，因此可以使用如下自定义方法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 自定义保留小数方法
 *
 * @param  {number} number 需要处理的数据
 * @param  {number} n      保留几位小数，可选，默认0
 * @return {string}        有返回值在写这个，没有不写return
 */</span>
<span class="token keyword">function</span> <span class="token function">toFixedDec</span><span class="token punctuation">(</span>number<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 保留小数点在0到20之间，超过报异常</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token number">20</span> <span class="token operator">||</span> n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RangeError</span><span class="token punctuation">(</span><span class="token string">'toFixedDec() digits argument must be between 0 and 20'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// number 不能转成数字、 是 NaN 或超过范围，返回对应字符串</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> number <span class="token operator">&gt;=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> number<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// null 和 undefined 会自动在这里报错</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 没有传 n 或 n === 0， 则直接返回整数</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'undefined'</span> <span class="token operator">||</span> n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> result <span class="token operator">=</span> number<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 整数的情况</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">+=</span> <span class="token string">'.'</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">+=</span> <span class="token string">'0'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> integer <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> decimal <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>decimal<span class="token punctuation">.</span>length <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>decimal<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n <span class="token operator">-</span> decimal<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">+=</span> <span class="token string">'0'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  result <span class="token operator">=</span> integer <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> decimal<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> last <span class="token operator">=</span> decimal<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 四舍五入，转换为整数再处理，避免浮点数精度的损失</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>last<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> x <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">parseFloat</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">*</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> x<span class="token punctuation">;</span>
    result <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">toFixedDec</span><span class="token punctuation">(</span><span class="token number">1.345</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">toFixedDec</span><span class="token punctuation">(</span><span class="token number">1.375</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">toFixedDec</span><span class="token punctuation">(</span><span class="token number">10.055</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">toFixedDec</span><span class="token punctuation">(</span><span class="token number">10.005</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">toFixedDec</span><span class="token punctuation">(</span><span class="token number">1234.3344</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>参考：https://juejin.cn/post/6844904161914388487 ，对参考的方法进行了优化和改进</p> <h2 id="_6-超大-小-数显示问题：解决数字显示中的-e-和-e"><a href="#_6-超大-小-数显示问题：解决数字显示中的-e-和-e" aria-hidden="true" class="header-anchor">#</a> 6. 超大(小)数显示问题：解决数字显示中的'e'和'E'</h2> <p>js中当数字很大或者很小时，会把数字用科学计数法来显示。</p> <p>科学记数法是一种记数的方法。把一个数表示成a与10的n次幂相乘的形式（1≤a&lt;10，n为整数），这种记数法叫做科学记数法。当我们要标记或运算某个较大或较小且位数较多时，用科学记数法免去浪费很多空间和时间。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> d<span class="token operator">=</span><span class="token number">0.00000000002</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// 2e-11</span>
<span class="token comment">// 科学计数法的显示是不影响数字计算</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>d<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// 2.00000000002</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>d<span class="token operator">+</span><span class="token number">0.00000000002</span><span class="token punctuation">)</span> <span class="token comment">// 4e-11</span>
</code></pre></div><p>大部分的页面中，数字不能显示为科学计数法，比如价值很高的商品(比特币)等，在交易计算过程中会出现科学计数法的情况，但是页面中显示不能显示为科学计数法，所以需要对科学计数法进行处理。</p> <p>自定义函数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">toolNumber</span><span class="token punctuation">(</span>num_str<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  num_str <span class="token operator">=</span> num_str<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>num_str<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'+'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    num_str <span class="token operator">=</span> num_str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'+'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>num_str<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'E'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> num_str<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'e'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> resValue <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span>
      power <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span>
      result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      dotIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
      resArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      sym <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> numStr <span class="token operator">=</span> num_str<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>numStr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'-'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果为负数，转成正数处理，先去掉‘-’号，并保存‘-’.</span>
      numStr <span class="token operator">=</span> numStr<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      sym <span class="token operator">=</span> <span class="token string">'-'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>numStr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'E'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> numStr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'e'</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> regExp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>
        <span class="token string">'^(((\\d+.?\\d+)|(\\d+))[Ee]{1}((-(\\d+))|(\\d+)))$'</span><span class="token punctuation">,</span>
        <span class="token string">'ig'</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      result <span class="token operator">=</span> regExp<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>numStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        resValue <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        power <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>resValue <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>power<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      dotIndex <span class="token operator">=</span> resValue<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token punctuation">:</span> resValue<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      resValue <span class="token operator">=</span> resValue<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      resArr <span class="token operator">=</span> resValue<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>power<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> subres <span class="token operator">=</span> resValue<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>dotIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        power <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>power<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 幂数大于小数点后面的数字位数时，后面加0</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> power <span class="token operator">-</span> subres<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          resArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>power <span class="token operator">-</span> subres<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          resArr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>dotIndex <span class="token operator">+</span> power<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        power <span class="token operator">=</span> power<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'-'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        power <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>power<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 幂数大于等于 小数点的index位置, 前面加0</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> power <span class="token operator">-</span> dotIndex<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          resArr<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">var</span> n <span class="token operator">=</span> power <span class="token operator">-</span> dotIndex <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token operator">-</span><span class="token punctuation">(</span>power <span class="token operator">-</span> dotIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        resArr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    resValue <span class="token operator">=</span> resArr<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> sym <span class="token operator">+</span> resValue<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num_str<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">0.000000009</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'0.000000009'</span><span class="token punctuation">)</span>                      <span class="token comment">// 0.000000009</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>                                  <span class="token comment">// 9e-9</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">toolNumber</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>                      <span class="token comment">// 0.000000009</span>

<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token number">10000000000000000000000</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'10000000000000000000000'</span><span class="token punctuation">)</span>           <span class="token comment">// 10000000000000000000000</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'10000000000000000000000'</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>    <span class="token comment">// 23</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>                                  <span class="token comment">// 1e+22</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">toolNumber</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>                       <span class="token comment">// 10000000000000000000000</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">toolNumber</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span>                <span class="token comment">// 23</span>
</code></pre></div><p>整理自：https://developer.aliyun.com/article/708291</p> <h2 id="参考资料"><a href="#参考资料" aria-hidden="true" class="header-anchor">#</a> 参考资料</h2> <p><a href="https://www.ruanyifeng.com/blog/2010/06/ieee_floating-point_representation.html" target="_blank" rel="noopener noreferrer">浮点数的二进制表示 阮一峰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://zh.wikipedia.org/wiki/IEEE_754" target="_blank" rel="noopener noreferrer">IEEE 754 标准 维基百科<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://www.html.cn/archives/7340" target="_blank" rel="noopener noreferrer">JavaScript 浮点数运算的精度问题<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://0.30000000000000004.com/" target="_blank" rel="noopener noreferrer">0.30000000004<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/yulilong/front-end-doc/edit/master/doc/js/013-JS数字计算精度和显示.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">3/10/2022, 2:12:27 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/21.149e4329.js" defer></script><script src="/assets/js/app.488c6ca2.js" defer></script>
  </body>
</html>
